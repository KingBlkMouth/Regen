<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Regen_Notes - Model Eval</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Regen_Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./1_Copied_Code.html" rel="" target="">
 <span class="menu-text">Plot Selection</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./2_Imputation.html" rel="" target="">
 <span class="menu-text">Imputation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./3_imputation_2.html" rel="" target="">
 <span class="menu-text">Imputation 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./4_Visualization.html" rel="" target="">
 <span class="menu-text">Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./5_Model_Eval.html" rel="" target="" aria-current="page">
 <span class="menu-text">Model Eval</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a>
  <ul class="collapse">
  <li><a href="#thoughts" id="toc-thoughts" class="nav-link" data-scroll-target="#thoughts">Thoughts</a></li>
  <li><a href="#yaimpute" id="toc-yaimpute" class="nav-link" data-scroll-target="#yaimpute">yaImpute</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#warning-threshold-zero-distances" id="toc-warning-threshold-zero-distances" class="nav-link" data-scroll-target="#warning-threshold-zero-distances">Warning threshold zero distances</a></li>
  <li><a href="#yaimpute-model-evaluation" id="toc-yaimpute-model-evaluation" class="nav-link" data-scroll-target="#yaimpute-model-evaluation">yaImpute model evaluation</a>
  <ul class="collapse">
  <li><a href="#variable-selection." id="toc-variable-selection." class="nav-link" data-scroll-target="#variable-selection.">Variable Selection.</a></li>
  </ul></li>
  <li><a href="#end-of-3-28" id="toc-end-of-3-28" class="nav-link" data-scroll-target="#end-of-3-28">End of 3-28</a></li>
  <li><a href="#bootstap-mean" id="toc-bootstap-mean" class="nav-link" data-scroll-target="#bootstap-mean">Bootstap mean</a>
  <ul class="collapse">
  <li><a href="#b2-log-mean" id="toc-b2-log-mean" class="nav-link" data-scroll-target="#b2-log-mean">B2 log mean</a></li>
  </ul></li>
  <li><a href="#rf" id="toc-rf" class="nav-link" data-scroll-target="#rf">RF</a></li>
  <li><a href="#leaving-on-april-fools-day." id="toc-leaving-on-april-fools-day." class="nav-link" data-scroll-target="#leaving-on-april-fools-day.">Leaving on april fools day.</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Model Eval</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
</section>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<p><a href="https://www.jstatsoft.org/article/view/v023i10">yaImpute Paper</a></p>
<p><a href="https://rdrr.io/rforge/yaImpute/">yaImpute package info</a></p>
<p>Breiman L (2001). “Random Forests.” Machine Learning, <a href="https://link.springer.com/article/10.1023/A:1010933404324">Breiman L 2001</a></p>
<p>Classification and Regression by randomForest <a href="https://cran.r-project.org/doc/Rnews/Rnews_2002-3.pdf">Liam &amp; Wiener, p.18</a></p>
<section id="thoughts" class="level3">
<h3 class="anchored" data-anchor-id="thoughts">Thoughts</h3>
<p>Obviously, we want to reduce rmsd. However, rmsd alone tells me nothing. I think the difference is the y values of the nearest neighbor to each reference plot minus the y values of that plot. RMSD is then the sum of squared differences divided by n.&nbsp; So for total_TD, rmsd is average difference in the number of total trees. When I ran the errorStats in impuation 2, msn.rmsd for PSME without zeroes was 261, with zeroes it was 265. When I ran the imputation, it was on the full set of data without subsetting a reference set. So, the difference is between all plots and the nearest 10 plots. I am pretty sure setting k to 10 makes it average each y variable.</p>
<p>On average, there were 4 more or less PSME in the targets vs references when comparing imputations with and without zeroes. However, both sets were on average different by about 263 trees. There is more variation between plots than there is between imputations.</p>
<p>For the same two sets of imputations, total_TD was 757 &amp; 803. On average, the imputations were different by 46, but the plots were different by 775. That is a lot of trees, too many in my opinion. I don’t know enough about forestry to really say, but reasonable TPAs for non-seedlings is between 300 and 900. Having a difference in seedlings that high may be normal, but I can’t say and it doesn’t seem normal.</p>
<p>I could try and figure out an appropriate metric based off the mean and sd. In the set imp_zx, there are on average about 64 PSME seedlings on plots that have an over story. Standard deviation is about 225. These data are almost distributed exponentially. A log transformation doesn’t make it normal. I cannot figure out how to deal with the distribution. So, I am going to treat it as if it were. I could try and bootstrap the mean and sd. That would at least smooth out the oddballs.</p>
<p>Bootstrapping it may have been a waste of time. For the full dataset, On average total_TD is 364 trees per acre plus or minus 64. 95% confidence interval is between 300 and 428 TPA. SD 95% is between 300 and 1194. So, we will get negative numbers often. For the subset without numbers over 10k and w/o zeroes, Without the outliers and zeroes, mean trees are 652 trees plus or minus 31. The true sd is 975 plus or minus 73.</p>
<p>So, there is too much variation in the whole set for anything to really make sense. I do not know how to model a log-normal distribution problem. I do not want zero in the confidence intervals. I can’t find anything straightforward about modeling this problem. It isn’t really an exponential distribution. The log transformations aren’t perfect.</p>
<p>All that being said, I think it is time that I got a little bit more info about RF. The variability issue could be fixed within RF. I would like to subset the data an dlook at variability within fpags, but I think RF will do well enough. I can go back and check a sampling of them, if I want to.</p>
</section>
<section id="yaimpute" class="level3">
<h3 class="anchored" data-anchor-id="yaimpute">yaImpute</h3>
<p><em>Paper</em> I’ve spent so much time trying to understand the stage and Crookston error stats paper. That time wasn’t a waste, but it isn’t how error works for random forests. In random forests, observation s are condsidered similar if they tend to end up in the same terminal node (in a suitably constructed collection of classification and regression trees.) <a href="https://cran.r-project.org/doc/Rnews/Rnews_2002-3.pdf">Liam &amp; Wiener, p.18</a></p>
<p>In RF, distance is based on a proximity matrix. There is a col and row for every observation. Inside the matrix is the number the proportion of trees where “plots” are in the same terminal node.</p>
<p>That matrix is too big though so the package uses an n by n_tree matrix. There are two, one for the references and one for the targets. For multivariate Ys, there is a separate forest for each Y. The node matrices for wach Y are joined at the end.</p>
<p>rmsd can never be zero. Notably distant finds references that aren’t as close as others. They are outside the range of variation of the references or they fall in large gaps. Specify a threshold distance by visualizing the frequency distribution. Hold the treshold constant when adding new data to fill the gaps.</p>
<ul>
<li>yaiVatImp is for variable importance.</li>
<li>rfSUmmary builds summary data.</li>
</ul>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data tidying and access</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">quietly =</span> T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(readxl)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(writexl)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># yaImpute and related </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaImpute)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plots and tables</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(esquisse)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># No sci-notation. </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Setup yai</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove test objects.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup something to remove anything that starts with t</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Then save everything else to Keep. </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> KEEP])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling from my new interim save point</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"./attempt_032524.db"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>imp_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from imp_data"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>zimp_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from regen_only_imp_data"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from fvs_plotinit_plot"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plants_ref <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from plants_ref"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(con)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sp_prev was saved from imutation 1</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"sp_prevalence.Rdata"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data <span class="sc">|&gt;</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fpa =</span> <span class="fu">str_sub</span>(FPAG, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">common =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prevalence<span class="sc">$</span>common]),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">uncommon =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prevalence<span class="sc">$</span>uncommon]),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">rare =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prevalence<span class="sc">$</span>rare]),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_TD =</span> <span class="fu">rowSums</span>(imp_data_FPA[<span class="fu">grep</span>(<span class="st">"_TD"</span>, <span class="fu">names</span>(imp_data_FPA))])</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sp_prevalence<span class="sc">$</span>rare, <span class="sc">-</span>sp_prevalence<span class="sc">$</span>uncommon, <span class="sc">-</span>sp_prevalence<span class="sc">$</span>common)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(fpa, <span class="at">.after =</span> FPAG)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># I am removing the extra rows to speed up the imputation test. </span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>fpas <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    total_TD <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># refs &lt;- rownames(fpas[1:(3*nrow(fpas)/4),])</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- fpas |&gt; select(1:5)</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- remove_rownames(x)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- column_to_rownames(x, "STANDPLOT_CN")</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co"># yfull &lt;- fpas |&gt; select(1, 7:ncol(fpas))</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- yfull[refs,]</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- remove_rownames(y)</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- column_to_rownames(y, "STANDPLOT_CN")</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="co"># yfull &lt;- remove_rownames(yfull)</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co"># yfull &lt;- column_to_rownames(yfull, "STANDPLOT_CN")</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="co"># k = 10</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co"># yrf &lt;- cbind(whatsMax(y[ ,1:(ncol(y)-1)]), y[, ncol(y)])</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co"># names(yrf) &lt;- c('Max_SP', 'sp_max_TD', 'total_TD')</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing the fpas with less than 120 plots. </span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> <span class="fu">group_by</span>(FPAG) <span class="sc">|&gt;</span> </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">120</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> t<span class="sc">$</span>FPAG</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FPAG <span class="sc">%in%</span> keep)</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>t2<span class="sc">$</span>FPAG <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(t2<span class="sc">$</span>FPAG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Run yai</strong></p>
<p><strong>I am tires right now, but this section looks weird</strong> Double check the imputation I have been doing for trf and check the above code.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>refs <span class="ot">&lt;-</span> <span class="fu">rownames</span>(t2[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">nrow</span>(t2)<span class="sc">/</span><span class="dv">4</span>),])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> t2 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(x)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(x, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> t2 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(t2))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> yfull[refs,]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(y)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(yfull)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(yfull, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>yrf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">whatsMax</span>(y[ ,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(y)<span class="sc">-</span><span class="dv">1</span>)]), y[, <span class="fu">ncol</span>(y)])</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yrf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Max_SP'</span>, <span class="st">'sp_max_TD'</span>, <span class="st">'total_TD'</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># trf &lt;- yai(x = x, y = yrf, method = "randomForest", k = k)</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># save(trf, file = "trf.Rdata")</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"trf.Rdata"</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>trf_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(trf, <span class="at">ancillaryData =</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="warning-threshold-zero-distances" class="level2">
<h2 class="anchored" data-anchor-id="warning-threshold-zero-distances">Warning threshold zero distances</h2>
<p><strong>I noticed at levels argument to msn in the yaImpute webstie, There may still be away to get that to work.</strong> It’s not really important right now because we have mostly decided to go with random forests.</p>
<p>The warning about zero distances is in reference to plots that have the same predictors. For example, if two or more plots share cc = 1, ba = 2, sdi = 10, they are separated by zero distance. Given the way this data was made, I am surprised that there aren’t more sets with the same predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(imp_data[, 2:4])</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(imp_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">CC</th>
<th style="text-align: left;">BA</th>
<th style="text-align: left;">SDI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.00</td>
<td style="text-align: left;">Min. : 0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.: 9.00</td>
<td style="text-align: left;">1st Qu.: 15.36</td>
<td style="text-align: left;">1st Qu.: 35.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :18.00</td>
<td style="text-align: left;">Median : 33.84</td>
<td style="text-align: left;">Median : 75.00</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :20.28</td>
<td style="text-align: left;">Mean : 40.11</td>
<td style="text-align: left;">Mean : 86.91</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:29.00</td>
<td style="text-align: left;">3rd Qu.: 58.47</td>
<td style="text-align: left;">3rd Qu.:126.00</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :97.00</td>
<td style="text-align: left;">Max. :226.84</td>
<td style="text-align: left;">Max. :497.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Canopy cover is an integer from 0:100, SDI is an int from 0 to 500 (in this set). Just them being integers makes them more likely to overlap.</p>
<div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(imp_data<span class="sc">$</span>CC, <span class="at">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(imp_data<span class="sc">$</span>BA, <span class="at">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(imp_data<span class="sc">$</span>SDI, <span class="at">breaks =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>All of them skew right and have lots of zeroes.</p>
<section id="test-removing-zero-distances." class="level4">
<h4 class="anchored" data-anchor-id="test-removing-zero-distances.">Test removing zero distances.</h4>
<p>Here, I was trying to figure out some code to pull the sets of data with zero distance between predictors out of the data. The correct answer was to use unique on the set of predictors after setting standplot_cn to rownames.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 527 zero distances of 1884</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>imp_zx <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CC <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> BA <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> SDI <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 40 zero distances. It isn't in the ancillary data, but that did help.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>imp_zx <span class="ot">&lt;-</span> imp_zx <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total_TD <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  15</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>imp_zx <span class="ot">&lt;-</span> imp_zx <span class="sc">|&gt;</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CC <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> BA <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> SDI <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>imp_zx <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CC <span class="sc">!=</span> BA <span class="sc">&amp;</span> CC <span class="sc">!=</span> SDI <span class="sc">&amp;</span> BA <span class="sc">!=</span> SDI)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>imp_zx <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">near</span>(CC, BA, <span class="at">tol =</span> .<span class="dv">01</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">near</span>(CC, SDI, <span class="at">tol =</span> .<span class="dv">01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Of the 1884 zero distances:</p>
<ul>
<li>All but 15, of the zero distances are where CC, BA, and SDI are all less than one.</li>
<li>All but 40 are accounted for in the set where total tree density is zero.</li>
</ul>
<p>This is the code to run the imputation as usual, with all the data.</p>
<p><em>It gives the errors, 1884 zero distances of 24621 references were set to 0.0…</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>imp_ztest <span class="ot">&lt;-</span> imp_data_FPA</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> imp_ztest <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, CC, BA, SDI)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(X)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(X, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> imp_ztest  <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, PSME_TD, common, total_TD)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(Y)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(Y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>mal <span class="ot">&lt;-</span> <span class="fu">yai</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">method =</span> <span class="st">"mahalanobis"</span>, <span class="at">k =</span> k)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>msn <span class="ot">&lt;-</span> <span class="fu">yai</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">method =</span> <span class="st">"msn"</span>, <span class="at">k =</span> k)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>ewz <span class="ot">&lt;-</span> <span class="fu">errorStats</span>(mal, msn)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>scaled_ewz <span class="ot">&lt;-</span> <span class="fu">errorStats</span>(mal, msn, <span class="at">scale =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here I am extracting the plots where there is zero distance in the predictors from the yai object, then joining the imputation data to those plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># msn$neiDstRefs rows of references with the distance to k neighbors</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## This run is had everything as a reference. </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>msn_0dist <span class="ot">&lt;-</span> msn<span class="sc">$</span>neiDstRefs <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting only distances for the k = 1 neighbor. </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>msn_0dist <span class="ot">&lt;-</span> msn_0dist[msn_0dist<span class="sc">$</span>Dst.k1 <span class="sc">==</span> <span class="dv">0</span>,]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the cns of those NN. </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>msn_0dist<span class="sc">$</span>STANDPLOT_CN <span class="ot">&lt;-</span> <span class="fu">row.names</span>(msn_0dist)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cns_0d <span class="ot">&lt;-</span> msn_0dist <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the imp data to the zero dist NN</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>test_all0s <span class="ot">&lt;-</span> <span class="fu">left_join</span>(cns_0d, imp_ztest, <span class="at">by =</span> <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>test_all0s <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(BA)) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">STANDPLOT_CN</th>
<th style="text-align: right;">CC</th>
<th style="text-align: right;">BA</th>
<th style="text-align: right;">SDI</th>
<th style="text-align: left;">FPAG</th>
<th style="text-align: left;">fpa</th>
<th style="text-align: right;">PSME_TD</th>
<th style="text-align: right;">ABLA_TD</th>
<th style="text-align: right;">ABAM_TD</th>
<th style="text-align: right;">TSHE_TD</th>
<th style="text-align: right;">common</th>
<th style="text-align: right;">uncommon</th>
<th style="text-align: right;">rare</th>
<th style="text-align: right;">total_TD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">346864308489998_1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">17.66684</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">CDS7</td>
<td style="text-align: left;">CDS</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">40220510010497_1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">17.66684</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">CPG2</td>
<td style="text-align: left;">CPG</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">22827756010497_1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">17.36355</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">CPS2</td>
<td style="text-align: left;">CPS</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">24208121010900_3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">17.36355</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">CERR</td>
<td style="text-align: left;">CER</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">484819578489998_2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">15.31406</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">CCF2</td>
<td style="text-align: left;">CCF</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">8625909010901_2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">15.31406</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">CD</td>
<td style="text-align: left;">CD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(test_all0s[,2:4])</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(test_all0s[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">CC</th>
<th style="text-align: left;">BA</th>
<th style="text-align: left;">SDI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. :0.0000</td>
<td style="text-align: left;">Min. : 0.000000</td>
<td style="text-align: left;">Min. : 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.:0.0000</td>
<td style="text-align: left;">1st Qu.: 0.000000</td>
<td style="text-align: left;">1st Qu.: 0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :0.0000</td>
<td style="text-align: left;">Median : 0.008177</td>
<td style="text-align: left;">Median : 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :0.6279</td>
<td style="text-align: left;">Mean : 1.057479</td>
<td style="text-align: left;">Mean : 1.739</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:1.0000</td>
<td style="text-align: left;">3rd Qu.: 1.029340</td>
<td style="text-align: left;">3rd Qu.: 2.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :8.0000</td>
<td style="text-align: left;">Max. :17.666840</td>
<td style="text-align: left;">Max. :34.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The above data frame shows that the zero distances are where the 3-D vector of<br>
predictors overlap. Adding more predictors would help.</p>
<p>I will now run the imputation data without those zero dist. NN.</p>
<p>This code runs the distance matrices without zero distances by using <code>unique()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>imp_ztest <span class="ot">&lt;-</span> imp_data_FPA</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">nrow</span>(imp_ztest)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting predictors only</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> imp_ztest <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, CC, BA, SDI)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Moving cns to get unique predictors</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(X)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(X, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Before and after unique</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24621</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22969</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_c</span>(<span class="st">"before minus after unique = "</span>, (b<span class="sc">-</span>a)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "before minus after unique = 1652"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding cns where predictors are unique</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(x, <span class="st">"STANDPLOT_CN"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering out the zero distances. </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>imp_zx <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x, imp_ztest, <span class="at">by =</span> <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting ancillary data. </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> imp_zx <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, PSME_TD, common, total_TD)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(Y)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(Y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>mal <span class="ot">&lt;-</span> <span class="fu">yai</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">method =</span> <span class="st">"mahalanobis"</span>, <span class="at">k =</span> k)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>msn <span class="ot">&lt;-</span> <span class="fu">yai</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">method =</span> <span class="st">"msn"</span>, <span class="at">k =</span> k)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>ewoz <span class="ot">&lt;-</span> <span class="fu">errorStats</span>(mal, msn)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>scaled_ewoz <span class="ot">&lt;-</span> <span class="fu">errorStats</span>(mal, msn, <span class="at">scale =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mal.see</th>
<th style="text-align: right;">mal.rmmsd0</th>
<th style="text-align: right;">mal.mlf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">221.8865</td>
<td style="text-align: right;">151.03480</td>
<td style="text-align: right;">194.4938</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">477.7440</td>
<td style="text-align: right;">621.49559</td>
<td style="text-align: right;">187.3791</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">842.9472</td>
<td style="text-align: right;">71.48992</td>
<td style="text-align: right;">841.4301</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mal.rmsd</th>
<th style="text-align: right;">mal.rmsdlg</th>
<th style="text-align: right;">mal.sei</th>
<th style="text-align: right;">mal.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">321.9114</td>
<td style="text-align: right;">398.3118</td>
<td style="text-align: right;">303.6794</td>
<td style="text-align: right;">284.2806</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">523.8155</td>
<td style="text-align: right;">596.5675</td>
<td style="text-align: right;">285.0513</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">428.8956</td>
<td style="text-align: right;">534.1788</td>
<td style="text-align: right;">425.9061</td>
<td style="text-align: right;">422.8955</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">msn.rmsd</th>
<th style="text-align: right;">msn.rmsdlg</th>
<th style="text-align: right;">msn.sei</th>
<th style="text-align: right;">msn.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">261.1057</td>
<td style="text-align: right;">330.3856</td>
<td style="text-align: right;">238.2654</td>
<td style="text-align: right;">212.9898</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">575.4805</td>
<td style="text-align: right;">679.7284</td>
<td style="text-align: right;">371.5500</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">756.9970</td>
<td style="text-align: right;">944.6343</td>
<td style="text-align: right;">755.3073</td>
<td style="text-align: right;">753.6138</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Of the 1884 zero distances of 24621 references in the original data, 1652 of those rows were not unique.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> test_all0s <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">t =</span> <span class="fu">round</span>(CC <span class="sc">+</span> BA <span class="sc">+</span> SDI, <span class="dv">4</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t<span class="sc">$</span>t, <span class="at">breaks =</span> <span class="dv">209</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribution of t, the sum of CC, BA, and SDI. Trying to see where the values of matching matching vectors exist. Most of the overlap is below 10 and zero. Meaning the values of CC + are low.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> t <span class="sc">|&gt;</span> <span class="fu">filter</span>(CC <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> BA <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> SDI <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tt &lt;- t |&gt; filter(CC != 0 &amp; BA != 0 &amp; SDI != 0)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> t <span class="sc">|&gt;</span> <span class="fu">filter</span>(t<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(t<span class="sc">$</span>t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 224</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t<span class="sc">$</span>t, <span class="at">breaks =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There are 224 distinct values (above zero) on 1205 plots. The rest of the 1884 plots were zero across the board, no BA, no trees in the over story or seedlings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> t <span class="sc">|&gt;</span> <span class="fu">group_by</span>(t) <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_plots_per_t =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_plots_per_t)) </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(t[t$t &lt; 1, c(1:4, 14:15)])</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(t[t<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 19%">
<col style="width: 11%">
<col style="width: 19%">
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">STANDPLOT_CN</th>
<th style="text-align: left;">CC</th>
<th style="text-align: left;">BA</th>
<th style="text-align: left;">SDI</th>
<th style="text-align: left;">total_TD</th>
<th style="text-align: left;">t</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Length:591</td>
<td style="text-align: left;">Min. :0</td>
<td style="text-align: left;">Min. :0.004089</td>
<td style="text-align: left;">Min. :0</td>
<td style="text-align: left;">Min. : 74.97</td>
<td style="text-align: left;">Min. :0.00410</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Class :character</td>
<td style="text-align: left;">1st Qu.:0</td>
<td style="text-align: left;">1st Qu.:0.004089</td>
<td style="text-align: left;">1st Qu.:0</td>
<td style="text-align: left;">1st Qu.: 74.97</td>
<td style="text-align: left;">1st Qu.:0.00410</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mode :character</td>
<td style="text-align: left;">Median :0</td>
<td style="text-align: left;">Median :0.008177</td>
<td style="text-align: left;">Median :0</td>
<td style="text-align: left;">Median :149.93</td>
<td style="text-align: left;">Median :0.00820</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Mean :0</td>
<td style="text-align: left;">Mean :0.012418</td>
<td style="text-align: left;">Mean :0</td>
<td style="text-align: left;">Mean :227.69</td>
<td style="text-align: left;">Mean :0.01243</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3rd Qu.:0</td>
<td style="text-align: left;">3rd Qu.:0.016355</td>
<td style="text-align: left;">3rd Qu.:0</td>
<td style="text-align: left;">3rd Qu.:299.86</td>
<td style="text-align: left;">3rd Qu.:0.01640</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Max. :0</td>
<td style="text-align: left;">Max. :0.040887</td>
<td style="text-align: left;">Max. :0</td>
<td style="text-align: left;">Max. :749.65</td>
<td style="text-align: left;">Max. :0.04090</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In the set of 1205 where the combined preds are above zero and less than one, there are 591 plots and only BA has values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The number of rows</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(t[t<span class="sc">$</span>t <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 591</code></pre>
</div>
</div>
<p>The number of rows between 0 and 1 is 591.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(t3, n  = 10)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(t3, <span class="at">n  =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">t</th>
<th style="text-align: right;">n_plots_per_t</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0041</td>
<td style="text-align: right;">230</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0082</td>
<td style="text-align: right;">96</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0123</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0164</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0204</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0245</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0286</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0327</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0368</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0450</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are 230 plots where t == 0.0041. 0.0368 &amp; 1.0450 both have 11 plots. For each set of t’s that match, like 0.0368 &amp; 1.0450, there are n_ts_per_nplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t3<span class="sc">$</span>n_plots_per_t, t3<span class="sc">$</span>t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The majority of zero distances plots only share a small number of values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> t3 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(n_plots_per_t) <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_ts_per_nplots =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_that_match =</span> n_ts_per_nplots <span class="sc">*</span> n_plots_per_t) <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_that_match))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tt, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">n_plots_per_t</th>
<th style="text-align: right;">n_ts_per_nplots</th>
<th style="text-align: right;">n_that_match</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">256</td>
</tr>
<tr class="even">
<td style="text-align: right;">230</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">230</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">114</td>
</tr>
<tr class="even">
<td style="text-align: right;">96</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">96</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">80</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="odd">
<td style="text-align: right;">64</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td style="text-align: right;">54</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">51</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">42</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(tt<span class="sc">$</span>n_that_match)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1205</code></pre>
</div>
</div>
<ul>
<li>There are 256 plots that match 2 times, on 128 different values of t.</li>
<li>There are 230 plots that match 230 times, on 1 value of t.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> t <span class="sc">|&gt;</span> <span class="fu">filter</span>(t <span class="sc">==</span> <span class="fl">0.0041</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> STANDPLOT_CN             CC          BA                SDI   
 Length:230         Min.   :0   Min.   :0.004089   Min.   :0  
 Class :character   1st Qu.:0   1st Qu.:0.004089   1st Qu.:0  
 Mode  :character   Median :0   Median :0.004089   Median :0  
                    Mean   :0   Mean   :0.004089   Mean   :0  
                    3rd Qu.:0   3rd Qu.:0.004089   3rd Qu.:0  
                    Max.   :0   Max.   :0.004089   Max.   :0  
     FPAG               fpa               PSME_TD         ABLA_TD      
 Length:230         Length:230         Min.   : 0.00   Min.   : 0.000  
 Class :character   Class :character   1st Qu.: 0.00   1st Qu.: 0.000  
 Mode  :character   Mode  :character   Median : 0.00   Median : 0.000  
                                       Mean   :14.67   Mean   : 6.193  
                                       3rd Qu.: 0.00   3rd Qu.: 0.000  
                                       Max.   :74.97   Max.   :74.965  
    ABAM_TD          TSHE_TD            common         uncommon    
 Min.   : 0.000   Min.   : 0.0000   Min.   : 0.00   Min.   : 0.00  
 1st Qu.: 0.000   1st Qu.: 0.0000   1st Qu.: 0.00   1st Qu.: 0.00  
 Median : 0.000   Median : 0.0000   Median : 0.00   Median : 0.00  
 Mean   : 1.956   Mean   : 0.3259   Mean   :34.22   Mean   : 8.80  
 3rd Qu.: 0.000   3rd Qu.: 0.0000   3rd Qu.:74.97   3rd Qu.: 0.00  
 Max.   :74.965   Max.   :74.9653   Max.   :74.97   Max.   :74.97  
      rare          total_TD           t         
 Min.   : 0.00   Min.   :74.97   Min.   :0.0041  
 1st Qu.: 0.00   1st Qu.:74.97   1st Qu.:0.0041  
 Median : 0.00   Median :74.97   Median :0.0041  
 Mean   : 8.80   Mean   :74.97   Mean   :0.0041  
 3rd Qu.: 0.00   3rd Qu.:74.97   3rd Qu.:0.0041  
 Max.   :74.97   Max.   :74.97   Max.   :0.0041  </code></pre>
</div>
</div>
<p>Of those 230 that share one value of t, there is no variation in predictors. There is variation at the species level, but not at the total tree level. These three predictors seem to be good at predicting the total tree density, but not the species present.</p>
<hr>
<p>Following are comparisons between the yai objects and distances for a yai with zeros and one without.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ewoz is the second row</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>malw <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ewz<span class="sc">$</span>mal, ewoz<span class="sc">$</span>mal)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># malw</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>msnw <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ewz<span class="sc">$</span>msn, ewoz<span class="sc">$</span>msn)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>commonw <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ewz<span class="sc">$</span>common, ewoz<span class="sc">$</span>common)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(malw) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PSME_TD"</span>, <span class="st">"common"</span>, <span class="st">"total_TD"</span>, <span class="st">"PSME_TD_wo0"</span>, <span class="st">"common_wo0"</span>, <span class="st">"total_TD_wo0"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>malw <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(malw, <span class="st">"source"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(msnw) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PSME_TD"</span>, <span class="st">"common"</span>, <span class="st">"total_TD"</span>, <span class="st">"PSME_TD_wo0"</span>, <span class="st">"common_wo0"</span>, <span class="st">"total_TD_wo0"</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>msnw <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(msnw, <span class="st">"source"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(commonw) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PSME_TD"</span>, <span class="st">"common"</span>, <span class="st">"total_TD"</span>, <span class="st">"PSME_TD_wo0"</span>, <span class="st">"common_wo0"</span>, <span class="st">"total_TD_wo0"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>commonw <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(commonw, <span class="st">"source"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>malw <span class="sc">|&gt;</span> <span class="fu">arrange</span>(source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">source</th>
<th style="text-align: right;">mal.rmsd</th>
<th style="text-align: right;">mal.rmsdlg</th>
<th style="text-align: right;">mal.sei</th>
<th style="text-align: right;">mal.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">312.0201</td>
<td style="text-align: right;">338.3963</td>
<td style="text-align: right;">297.0426</td>
<td style="text-align: right;">281.2686</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSME_TD_wo0</td>
<td style="text-align: right;">321.9114</td>
<td style="text-align: right;">398.3118</td>
<td style="text-align: right;">303.6794</td>
<td style="text-align: right;">284.2806</td>
</tr>
<tr class="odd">
<td style="text-align: left;">common</td>
<td style="text-align: right;">510.7842</td>
<td style="text-align: right;">524.6831</td>
<td style="text-align: right;">472.1028</td>
<td style="text-align: right;">429.9554</td>
</tr>
<tr class="even">
<td style="text-align: left;">common_wo0</td>
<td style="text-align: right;">523.8155</td>
<td style="text-align: right;">596.5675</td>
<td style="text-align: right;">285.0513</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">413.7486</td>
<td style="text-align: right;">455.0015</td>
<td style="text-align: right;">413.7486</td>
<td style="text-align: right;">413.7486</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD_wo0</td>
<td style="text-align: right;">428.8956</td>
<td style="text-align: right;">534.1788</td>
<td style="text-align: right;">425.9061</td>
<td style="text-align: right;">422.8955</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For mahalonobis (read as euclidian distance), the yai without zeroes was higher in all categories except for common trees standard error of imputation. I don’t know why the distance component is NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>msnw <span class="sc">|&gt;</span> <span class="fu">arrange</span>(source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">source</th>
<th style="text-align: right;">msn.rmsd</th>
<th style="text-align: right;">msn.rmsdlg</th>
<th style="text-align: right;">msn.sei</th>
<th style="text-align: right;">msn.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">264.9361</td>
<td style="text-align: right;">285.4914</td>
<td style="text-align: right;">247.1212</td>
<td style="text-align: right;">227.9180</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSME_TD_wo0</td>
<td style="text-align: right;">261.1057</td>
<td style="text-align: right;">330.3856</td>
<td style="text-align: right;">238.2654</td>
<td style="text-align: right;">212.9898</td>
</tr>
<tr class="odd">
<td style="text-align: left;">common</td>
<td style="text-align: right;">625.0536</td>
<td style="text-align: right;">676.6855</td>
<td style="text-align: right;">593.8624</td>
<td style="text-align: right;">560.9394</td>
</tr>
<tr class="even">
<td style="text-align: left;">common_wo0</td>
<td style="text-align: right;">575.4805</td>
<td style="text-align: right;">679.7284</td>
<td style="text-align: right;">371.5500</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">803.3972</td>
<td style="text-align: right;">869.4654</td>
<td style="text-align: right;">803.3972</td>
<td style="text-align: right;">803.3972</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD_wo0</td>
<td style="text-align: right;">756.9970</td>
<td style="text-align: right;">944.6343</td>
<td style="text-align: right;">755.3073</td>
<td style="text-align: right;">753.6138</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For msn (canonical correlation) without zeros was generally lower, except root mean square error of the observations with larger distances (rmsdlg) and common trees SEI.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>commonw <span class="sc">|&gt;</span> <span class="fu">arrange</span>(source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">source</th>
<th style="text-align: right;">mal.see</th>
<th style="text-align: right;">mal.rmmsd0</th>
<th style="text-align: right;">mal.mlf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">215.3464</td>
<td style="text-align: right;">135.0722786</td>
<td style="text-align: right;">193.0073</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSME_TD_wo0</td>
<td style="text-align: right;">221.8865</td>
<td style="text-align: right;">151.0348025</td>
<td style="text-align: right;">194.4938</td>
</tr>
<tr class="odd">
<td style="text-align: left;">common</td>
<td style="text-align: right;">466.4442</td>
<td style="text-align: right;">275.7514975</td>
<td style="text-align: right;">423.7343</td>
</tr>
<tr class="even">
<td style="text-align: left;">common_wo0</td>
<td style="text-align: right;">477.7440</td>
<td style="text-align: right;">621.4955878</td>
<td style="text-align: right;">187.3791</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">819.0953</td>
<td style="text-align: right;">0.0000003</td>
<td style="text-align: right;">819.0953</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD_wo0</td>
<td style="text-align: right;">842.9472</td>
<td style="text-align: right;">71.4899191</td>
<td style="text-align: right;">841.4301</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For the common stats that are used to compute the others, model lack of fit is much better for common trees. There is also an expectedly large difference for rmsd near 0. rmmsd0 is a measure of variability, pure error, measurement error, and bias. Bias is the squraed average distance compoents in that group.</p>
<hr>
<p>This was a test to see what they look like when scaled.</p>
<p><strong>With zeroes</strong></p>
<p><strong>Without zeroes</strong></p>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mal.see</th>
<th style="text-align: right;">mal.rmmsd0</th>
<th style="text-align: right;">mal.mlf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">0.9878199</td>
<td style="text-align: right;">0.6195928</td>
<td style="text-align: right;">0.8853476</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">0.9762440</td>
<td style="text-align: right;">0.5771339</td>
<td style="text-align: right;">0.8868543</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.8234868</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.8234868</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mal.see</th>
<th style="text-align: right;">mal.rmmsd0</th>
<th style="text-align: right;">mal.mlf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">0.9872021</td>
<td style="text-align: right;">0.6719737</td>
<td style="text-align: right;">0.8653286</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">0.9756580</td>
<td style="text-align: right;">1.2692303</td>
<td style="text-align: right;">0.3826693</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.8230136</td>
<td style="text-align: right;">0.0697994</td>
<td style="text-align: right;">0.8215324</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="yaimpute-model-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="yaimpute-model-evaluation">yaImpute model evaluation</h2>
<p>For each set, the total_TDs are the same. That is interesting. Explore the tree values for combinations of cc, ba, and sdi. Do the predictors do well at finding total td, but not per species.</p>
<section id="variable-selection." class="level3">
<h3 class="anchored" data-anchor-id="variable-selection.">Variable Selection.</h3>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7508310/">Variable Selection</a></p>
<p>Performance based approaches select variables based on changes in the prediction accuracy when variables are added or deleted from models, and include methods by Svetnik and Jiang, varSelRF, caret, RRF, SRC and VSURF.</p>
<p>They are using area under the curve as an indicator of fit/performance.</p>
<p>Regular RF had the highest OOB error rate. I think that yaImpute uses regular RF.</p>
<p>Jiang looks worth checking out. SVETNIK too. These two performed best for error, comp time, and accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(scaled_ewz<span class="sc">$</span>mal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mal.rmsd</th>
<th style="text-align: right;">mal.rmsdlg</th>
<th style="text-align: right;">mal.sei</th>
<th style="text-align: right;">mal.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">1.4312740</td>
<td style="text-align: right;">1.552265</td>
<td style="text-align: right;">1.3625703</td>
<td style="text-align: right;">1.2902132</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">1.0690455</td>
<td style="text-align: right;">1.098135</td>
<td style="text-align: right;">0.9880873</td>
<td style="text-align: right;">0.8998749</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.4159669</td>
<td style="text-align: right;">0.457441</td>
<td style="text-align: right;">0.4159669</td>
<td style="text-align: right;">0.4159669</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(scaled_ewoz<span class="sc">$</span>mal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mal.rmsd</th>
<th style="text-align: right;">mal.rmsdlg</th>
<th style="text-align: right;">mal.sei</th>
<th style="text-align: right;">mal.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">1.4322261</td>
<td style="text-align: right;">1.7721414</td>
<td style="text-align: right;">1.3511096</td>
<td style="text-align: right;">1.2648015</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">1.0697461</td>
<td style="text-align: right;">1.2183216</td>
<td style="text-align: right;">0.5821373</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.4187533</td>
<td style="text-align: right;">0.5215468</td>
<td style="text-align: right;">0.4158345</td>
<td style="text-align: right;">0.4128951</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(scaled_ewz<span class="sc">$</span>msn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">msn.rmsd</th>
<th style="text-align: right;">msn.rmsdlg</th>
<th style="text-align: right;">msn.sei</th>
<th style="text-align: right;">msn.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">1.2152940</td>
<td style="text-align: right;">1.309583</td>
<td style="text-align: right;">1.1335748</td>
<td style="text-align: right;">1.0454876</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">1.3082054</td>
<td style="text-align: right;">1.416268</td>
<td style="text-align: right;">1.2429238</td>
<td style="text-align: right;">1.1740178</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.8077045</td>
<td style="text-align: right;">0.874127</td>
<td style="text-align: right;">0.8077045</td>
<td style="text-align: right;">0.8077045</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(scaled_ewoz<span class="sc">$</span>msn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">msn.rmsd</th>
<th style="text-align: right;">msn.rmsdlg</th>
<th style="text-align: right;">msn.sei</th>
<th style="text-align: right;">msn.dstc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">1.161693</td>
<td style="text-align: right;">1.4699291</td>
<td style="text-align: right;">1.0600742</td>
<td style="text-align: right;">0.9476197</td>
</tr>
<tr class="even">
<td style="text-align: left;">common</td>
<td style="text-align: right;">1.175257</td>
<td style="text-align: right;">1.3881544</td>
<td style="text-align: right;">0.7587867</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.739096</td>
<td style="text-align: right;">0.9222961</td>
<td style="text-align: right;">0.7374462</td>
<td style="text-align: right;">0.7357927</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
<p>Note to self, the magrittr pipe and native pipe are different. The magrittr pipe allows for substituting the position of the left hand side argument on the right with a “.”. The native pipe doesn’t. Curly braces overide the lhs to first argument rule. There is also an pipe called the exposition pipe, %$%.</p>
</section>
</section>
<section id="end-of-3-28" class="level2">
<h2 class="anchored" data-anchor-id="end-of-3-28">End of 3-28</h2>
<p>I am trying to figure out how to decide on a reasonable model. I accidentally wasted a day trying to figure out what is going on with the zero distances. It feels important to know that but it also doesn’t. I don’t know how RF is comparable with mal or msn. I need to get an idea of what to compare then run some tests to decide if we are close enough.</p>
</section>
<section id="bootstap-mean" class="level2">
<h2 class="anchored" data-anchor-id="bootstap-mean">Bootstap mean</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(imp_zx<span class="sc">$</span>total_TD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 363.6415</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(imp_zx<span class="sc">$</span>total_TD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1024.22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(imp_zx<span class="sc">$</span>PSME_TD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.41634</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(imp_zx<span class="sc">$</span>PSME_TD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 224.763</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>many_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> imp_zx<span class="sc">$</span>total_TD, <span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> T)))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(many_means, <span class="at">breaks =</span> <span class="dv">100</span>, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">paste</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">"mean is "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(many_means)), <span class="st">" sd is "</span>, <span class="fu">round</span>(<span class="fu">sd</span>(many_means))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>       ))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(many_means), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> (<span class="fu">mean</span>(many_means)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_means)), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> (<span class="fu">mean</span>(many_means)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_means)), <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On average total_TD is 364 trees per acre plus or minus 64. 95% confidence interval is between 300 and 428 TPA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(many_means) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 428.055</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(many_means) <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 298.8961</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(imp_zx<span class="sc">$</span>total_TD))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>imp_zxx <span class="ot">&lt;-</span> imp_zx <span class="sc">|&gt;</span> <span class="fu">filter</span>(total_TD <span class="sc">&lt;</span> <span class="dv">10000</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>many_sds <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100000</span>, <span class="fu">sd</span>(<span class="fu">sample</span>(<span class="at">x =</span> imp_zxx<span class="sc">$</span>total_TD, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> T)))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(many_sds, <span class="at">breaks =</span> <span class="dv">100</span>, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">paste</span>(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>       <span class="st">"mean is "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(many_sds)), <span class="st">" sd is "</span>, <span class="fu">round</span>(<span class="fu">sd</span>(many_sds))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>       ))</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(many_sds), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> (<span class="fu">mean</span>(many_sds)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_sds)), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> (<span class="fu">mean</span>(many_sds)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_sds)), <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>SD 95% is between 300 and 1194.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(many_sds) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1191.937</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(many_sds) <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(many_sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 300.4298</code></pre>
</div>
</div>
<p>On average total_TD is 364 trees per acre plus or minus 64. 95% confidence interval is between 300 and 428 TPA. SD 95% is between 300 and 1194. So, we will get negative numbers often.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="fu">mean</span>(many_means), <span class="at">sd =</span> <span class="fu">mean</span>(many_sds))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-1191.9  -111.3   225.5   194.5   666.3  1390.8 </code></pre>
</div>
</div>
<section id="b2-log-mean" class="level3">
<h3 class="anchored" data-anchor-id="b2-log-mean">B2 log mean</h3>
<p>Checking it out without the outliers and zeroes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>imp_zxx <span class="ot">&lt;-</span> imp_zx <span class="sc">|&gt;</span> <span class="fu">filter</span>(total_TD <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> total_TD <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>many_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">log</span>(<span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> imp_zxx<span class="sc">$</span>total_TD, <span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> T))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(imp_zxx<span class="sc">$</span>total_TD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 651.0511</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(imp_zxx<span class="sc">$</span>total_TD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 979.7399</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">density</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(imp_zxx<span class="sc">$</span>total_TD)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">mean</span>(imp_zxx<span class="sc">$</span>total_TD)) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 651.0511</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">sd</span>(imp_zxx<span class="sc">$</span>total_TD)) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 979.7399</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(many_means), <span class="at">breaks =</span> <span class="dv">100</span>, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">paste</span>(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean is "</span>, <span class="fu">round</span>(</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">exp</span>(<span class="fu">mean</span>(many_means))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>      ), <span class="st">" sd is "</span>, <span class="fu">round</span>(</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sd</span>(<span class="fu">exp</span>(many_means)),<span class="dv">2</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(many_means)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">v =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(many_means)) <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(many_means)), </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">v =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(many_means)) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(many_means)), </span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>imp_zxx <span class="ot">&lt;-</span> imp_zx <span class="sc">|&gt;</span> <span class="fu">filter</span>(total_TD <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> total_TD <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>many_sds <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">log</span>(<span class="fu">sd</span>(<span class="fu">sample</span>(<span class="at">x =</span> imp_zxx<span class="sc">$</span>total_TD, <span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> T))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(many_sds), <span class="at">breaks =</span> <span class="dv">100</span>, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">paste</span>(</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean is "</span>, <span class="fu">round</span>(</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(<span class="fu">exp</span>(many_sds)),<span class="dv">2</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>      ), <span class="st">" sd is "</span>, <span class="fu">round</span>(</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sd</span>(<span class="fu">exp</span>(many_sds)),<span class="dv">2</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(many_sds)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">v =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(many_sds)) <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(many_sds)), </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">v =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(many_sds)) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(many_sds)), </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(many_means))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 651.1653</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">exp</span>(many_means))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31.15028</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(many_sds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 977.7553</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">exp</span>(many_sds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72.75831</code></pre>
</div>
</div>
<p>Without the outliers and zeroes, mean trees are 652 trees plus or minus 31. The true sd is 975 plus or minus 73.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>many_sds <span class="ot">&lt;-</span> <span class="fu">exp</span>(many_sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="rf" class="level2">
<h2 class="anchored" data-anchor-id="rf">RF</h2>
<p>**This is copied from imp 2. It makes the rf with physcd and adds data to trf, test rf for fpag.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"./attempt_032524.db"</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>imp_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from imp_data"</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>zimp_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from regen_only_imp_data"</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from fvs_plotinit_plot"</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>plants_ref <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from plants_ref"</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(con)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"sp_prevalence.Rdata"</span>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="fu">append</span>(KEEP, <span class="fu">c</span>(<span class="st">"imp_data"</span>, <span class="st">"zimp_data"</span>, <span class="st">"plots"</span>, <span class="st">"plants_ref"</span>, <span class="st">"sp_prevalence"</span>))</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>pred_topo <span class="ot">&lt;-</span> plots <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>  STANDPLOT_CN, ELEVFT, SLOPE, ASPECT</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>pred_Kral <span class="ot">&lt;-</span> imp_data <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>  STANDPLOT_CN, CC, BA, SDI, FPAG</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> imp_data <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">c</span>(CC, BA, SDI, FPAG)</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">left_join</span>(pred_Kral, pred_topo, <span class="fu">join_by</span>(STANDPLOT_CN))<span class="sc">|&gt;</span> </span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(FPAG, <span class="at">.after =</span> STANDPLOT_CN)</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"../../Data/_FIADB_WA.db"</span>)</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>cond <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select PLT_CN, CONDID, PHYSCLCD from cond"</span>)</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="fu">append</span>(KEEP, <span class="fu">c</span>(<span class="st">"cond"</span>))</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./good_SUB_plots2.csv"</span>, </span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"cccci"</span>))</span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">left_join</span>(g, cond, <span class="fu">join_by</span>(PLT_CN, CONDID))</span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">STANDPLOT_CN =</span> <span class="fu">str_c</span>(PLT_CN, <span class="st">"_"</span>, SUBP)</span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>SUBPLOT_CN)</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(plots, g, <span class="fu">join_by</span>(STANDPLOT_CN))</span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, PHYSCLCD)</span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a>imp_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(imp_data, y, <span class="fu">join_by</span>(STANDPLOT_CN))</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a>imp_data <span class="ot">&lt;-</span> imp_data <span class="sc">|&gt;</span> <span class="fu">relocate</span>(PHYSCLCD, <span class="at">.after =</span> FPAG)</span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> predictors <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, ELEVFT, SLOPE, ASPECT)</span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>imp_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(imp_data, y, <span class="fu">join_by</span>(STANDPLOT_CN))</span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a>imp_data <span class="ot">&lt;-</span> imp_data <span class="sc">|&gt;</span> <span class="fu">relocate</span>(ELEVFT, SLOPE, ASPECT, <span class="at">.after =</span> SDI)</span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data <span class="sc">|&gt;</span> </span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">fpa =</span> <span class="fu">str_sub</span>(FPAG, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="fu">append</span>(KEEP, <span class="st">"imp_data_FPA"</span>)</span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(</span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">common =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prevalence<span class="sc">$</span>common]),</span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">uncommon =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prevalence<span class="sc">$</span>uncommon]),</span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">rare =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prevalence<span class="sc">$</span>rare]),</span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_TD =</span> <span class="fu">rowSums</span>((imp_data_FPA[<span class="fu">grep</span>(<span class="st">"_TD"</span>, <span class="fu">names</span>(imp_data_FPA))]))</span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sp_prevalence<span class="sc">$</span>rare, <span class="sc">-</span>sp_prevalence<span class="sc">$</span>uncommon, <span class="sc">-</span>sp_prevalence<span class="sc">$</span>common)</span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(fpa, <span class="at">.after =</span> FPAG)</span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> <span class="fu">relocate</span>(PHYSCLCD, <span class="at">.before =</span> FPAG)</span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a><span class="co"># I am removing the extra rows to speed up the imputation test. </span></span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a>fpas <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb83-83"><a href="#cb83-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb83-84"><a href="#cb83-84" aria-hidden="true" tabindex="-1"></a>    total_TD <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="fu">append</span>(KEEP, <span class="st">"fpas"</span>)</span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> <span class="fu">group_by</span>(FPAG) <span class="sc">|&gt;</span> </span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">120</span>)</span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> t<span class="sc">$</span>FPAG</span>
<span id="cb83-94"><a href="#cb83-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-95"><a href="#cb83-95" aria-hidden="true" tabindex="-1"></a>fpas <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> </span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FPAG <span class="sc">%in%</span> keep)</span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a>fpas<span class="sc">$</span>FPAG <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(fpas<span class="sc">$</span>FPAG)</span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a>fpas<span class="sc">$</span>PHYSCLCD <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(fpas<span class="sc">$</span>PHYSCLCD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> KEEP <span class="sc">|&gt;</span> <span class="fu">append</span>(<span class="st">"KEEP"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> KEEP])</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>refs <span class="ot">&lt;-</span> <span class="fu">rownames</span>(fpas[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">nrow</span>(fpas)<span class="sc">/</span><span class="dv">4</span>),])</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fpas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "STANDPLOT_CN" "CC"           "BA"           "SDI"          "ELEVFT"      
 [6] "SLOPE"        "ASPECT"       "PHYSCLCD"     "FPAG"         "fpa"         
[11] "PSME_TD"      "ABLA_TD"      "ABAM_TD"      "TSHE_TD"      "common"      
[16] "uncommon"     "rare"         "total_TD"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(x)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(x, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(fpas))</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> yfull[refs,]</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(y)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(yfull)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(yfull, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>yrf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">whatsMax</span>(y[ ,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(y)<span class="sc">-</span><span class="dv">1</span>)]), y[, <span class="fu">ncol</span>(y)])</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yrf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Max_SP'</span>, <span class="st">'sp_max_TD'</span>, <span class="st">'total_TD'</span>)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="co"># rf_all_ps &lt;- yai(x = x, y = yrf, method = "randomForest", k = k)</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co"># save(rf_all_ps, file = "rf_all_ps.Rdata")</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"rf_phys.Rdata"</span>)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"trf.Rdata"</span>)</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"rf_all_ps.Rdata"</span>)</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>rf_all_ps_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_all_ps, <span class="at">ancillaryData =</span> y)</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>trf_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(trf, <span class="at">ancillaryData =</span> y)</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>rf_phys_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_phys, <span class="at">ancillaryData =</span> y)</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="fu">append</span>(KEEP, <span class="fu">c</span>(<span class="st">"rf_all_ps"</span>, <span class="st">"trf"</span>, <span class="st">"rf_phys"</span>, <span class="st">"rf_all_ps_i"</span>, <span class="st">"trf_i"</span>, <span class="st">"rf_phys_i"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>yaiVatImp is for variable importance.</li>
<li>rfSUmmary builds summary data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_all_ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiRFsummary</span>(rf_all_ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$forestAttributes
          ntree       error         errtag levels           type
Max_SP      166 0.340995647 OOB error rate      7 classification
sp_max_TD   166 0.008569097 OOB error rate      7 classification
total_TD    166 0.011425462 OOB error rate      7 classification

$scaledImportance
                   BA        SDI         CC        FPAG     ELEVFT      SLOPE
Max_SP    -0.09804926 0.04201951 -0.5668497  1.88086175  1.0872913 -0.5087380
sp_max_TD  1.34163672 1.26761289  0.6381319 -0.12173191 -0.2529331 -0.5583848
total_TD   1.65899078 0.89617704  0.5641649  0.03317348 -0.2197486 -0.7021302
              ASPECT   PHYSCLCD
Max_SP    -0.9515318 -0.8850038
sp_max_TD -0.9149850 -1.3993467
total_TD  -0.8961013 -1.3345261</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_phys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiRFsummary</span>(rf_phys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$forestAttributes
          ntree       error         errtag levels           type
Max_SP      166 0.273750753 OOB error rate      8 classification
sp_max_TD   166 0.004154124 OOB error rate      7 classification
total_TD    166 0.005237809 OOB error rate      7 classification

$scaledImportance
                BA       SDI         CC       FPAG  PHYSCLCD
Max_SP    1.128922 0.9682485 -0.6065932 -0.3521191 -1.138458
sp_max_TD 1.109901 0.8976865 -0.1966440 -0.5287400 -1.282203
total_TD  1.225553 0.8347193 -0.2947947 -0.6035393 -1.161938</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(trf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_Model_Eval_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiRFsummary</span>(trf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$forestAttributes
          ntree      error         errtag levels           type
Max_SP      166 0.40590557 OOB error rate      7 classification
sp_max_TD   166 0.00789223 OOB error rate      7 classification
total_TD    166 0.01020547 OOB error rate      7 classification

$scaledImportance
                  BA        SDI         CC      FPAG
Max_SP    -0.3703799 -0.4028081 -0.7092286  1.482417
sp_max_TD  0.8999042  0.8072323 -0.6518370 -1.055300
total_TD   1.0415167  0.6546549 -0.6928911 -1.003281</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">compare.yai</span>(trf_i, rf_phys_i, rf_all_ps_i, <span class="at">scale =</span> F)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">trf_i.rmsdS</th>
<th style="text-align: right;">rf_phys_i.rmsdS</th>
<th style="text-align: right;">rf_all_ps_i.rmsdS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">266.1156</td>
<td style="text-align: right;">297.5946</td>
<td style="text-align: right;">303.9086</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABLA_TD</td>
<td style="text-align: right;">354.0954</td>
<td style="text-align: right;">384.9643</td>
<td style="text-align: right;">371.7980</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABAM_TD</td>
<td style="text-align: right;">380.8726</td>
<td style="text-align: right;">410.7614</td>
<td style="text-align: right;">391.8953</td>
</tr>
<tr class="even">
<td style="text-align: left;">TSHE_TD</td>
<td style="text-align: right;">673.2647</td>
<td style="text-align: right;">720.9237</td>
<td style="text-align: right;">696.5747</td>
</tr>
<tr class="odd">
<td style="text-align: left;">common</td>
<td style="text-align: right;">663.5073</td>
<td style="text-align: right;">713.6788</td>
<td style="text-align: right;">688.8337</td>
</tr>
<tr class="even">
<td style="text-align: left;">uncommon</td>
<td style="text-align: right;">427.1661</td>
<td style="text-align: right;">459.7389</td>
<td style="text-align: right;">414.7905</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rare</td>
<td style="text-align: right;">217.4765</td>
<td style="text-align: right;">228.7634</td>
<td style="text-align: right;">204.1509</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">996.9510</td>
<td style="text-align: right;">1143.1015</td>
<td style="text-align: right;">1215.5034</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="leaving-on-april-fools-day." class="level2">
<h2 class="anchored" data-anchor-id="leaving-on-april-fools-day.">Leaving on april fools day.</h2>
<p>I am surprised by this, it looks like the rmsd is not better. I need to check these out and figure out what is going on.</p>
<p>Looking back at the msn, mal, and older RFs to see what the rmsds were.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>