<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Regen_Notes - Predictors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Regen_Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./1_Copied_Code.html" rel="" target="">
 <span class="menu-text">Plot Selection</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./2_Imputation.html" rel="" target="">
 <span class="menu-text">Imputation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./3_imputation_2.html" rel="" target="">
 <span class="menu-text">Imputation 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./5_Model_Eval.html" rel="" target="">
 <span class="menu-text">Model Eval</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./6_Model_Eval_2.html" rel="" target="">
 <span class="menu-text">Model Eval 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./4_Visualization.html" rel="" target="">
 <span class="menu-text">Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./7_Predictors.html" rel="" target="" aria-current="page">
 <span class="menu-text">Predictors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./8_log_normal.html" rel="" target="">
 <span class="menu-text">Imp log-normal</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#pulling-apart-fpag" id="toc-pulling-apart-fpag" class="nav-link" data-scroll-target="#pulling-apart-fpag">Pulling apart FPAG</a></li>
  <li><a href="#yai" id="toc-yai" class="nav-link" data-scroll-target="#yai">Yai</a>
  <ul class="collapse">
  <li><a href="#eval" id="toc-eval" class="nav-link" data-scroll-target="#eval">eval</a></li>
  <li><a href="#now-what" id="toc-now-what" class="nav-link" data-scroll-target="#now-what">Now what?</a></li>
  </ul></li>
  <li><a href="#moving-on" id="toc-moving-on" class="nav-link" data-scroll-target="#moving-on">Moving on</a></li>
  <li><a href="#eco-region" id="toc-eco-region" class="nav-link" data-scroll-target="#eco-region">eco-region</a></li>
  <li><a href="#ba-overstory" id="toc-ba-overstory" class="nav-link" data-scroll-target="#ba-overstory">BA overstory</a>
  <ul class="collapse">
  <li><a href="#lets-see" id="toc-lets-see" class="nav-link" data-scroll-target="#lets-see">Let’s see</a></li>
  <li><a href="#eval-1" id="toc-eval-1" class="nav-link" data-scroll-target="#eval-1">eval</a></li>
  </ul></li>
  <li><a href="#removing-negative-preds" id="toc-removing-negative-preds" class="nav-link" data-scroll-target="#removing-negative-preds">Removing negative preds</a></li>
  <li><a href="#oob-errors" id="toc-oob-errors" class="nav-link" data-scroll-target="#oob-errors">OOB errors</a>
  <ul class="collapse">
  <li><a href="#checking-on-oob-v-rmsd" id="toc-checking-on-oob-v-rmsd" class="nav-link" data-scroll-target="#checking-on-oob-v-rmsd">Checking on OOB v rmsd</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predictors</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level1">
<h1>Summary</h1>
<p>All of the imputations were run on the clipped set of references, w/ 2.5% of extreme values removed.</p>
<ul>
<li>Copying in code from the last docs</li>
<li>Setting up to run imputations</li>
<li>Breaking FPAG into F, P, A &amp; G</li>
<li>rf_f.p.a.g is that imputation.</li>
<li>rf_fpag_bs is the same, but bootstrapped
<ul>
<li>Regular RF has an out-of-bag error, I wanted to see how different it was bootstrapped</li>
<li>Both use the same three quarters of rows as references, but BS samples from them.</li>
</ul></li>
<li>Splitting it was a mixed bag. For major species and rare groups, it was mixed.
<ul>
<li>No overall increase in accuracy</li>
<li>Major spp, rmsd 3 of 11 have rmsd greater than sd.</li>
<li>OOB error for UN-bootstrapped one was about .25</li>
<li>OOB error for bootstrapped one was about .1</li>
</ul></li>
<li>Variable importance is scaled, every run different, but
<ul>
<li>BA and SDI are always good predictors, CC is okay.</li>
<li>From fpag, f, a and g are bad ones. Aspect, physcldc and sometimes slope are medium to bad</li>
</ul></li>
<li>Decreasing OOB error didn’t affect rmsd</li>
</ul>
<p>Everything after rf_f.p.a.g was run bootstrapped.</p>
<ul>
<li>Eco-region and large tree DBH as predictors:
<ul>
<li>For rmsd, Eco-region(rf_eco) and species DBH(rf_dia) were mostly the same as the others.</li>
<li>The dbh run was done with sum of each species’ DBH per subplot. The three largest DBH per plot were used.</li>
<li>I considered trying it as DBH per tree.</li>
<li>493 subplots didn’t have major overstory species. Then 493 were removed by yai.</li>
</ul></li>
</ul>
<p>Removing negative value predictors.</p>
<p>I ran the eco and dia imputations again, but with the most negative predictors from yaiVarImp removed. Both have the form rf_…2</p>
<ul>
<li>They were no better for rmsd</li>
<li>Dia2 was the best for OOB error at 0.10554326 0.08814208 0.09304551 for the yrf variables (‘Max_SP’, ‘sp_max_TD’, ‘total_TD’)</li>
<li>Removing negatively important variables reduces OOB, but not rmsd.</li>
</ul>
<p>OOB</p>
</section>
<section id="notes" class="level1">
<h1>Notes</h1>
<ul>
<li><p>Brieman paper, generalization error, classifier strength and dependence are computed. These are called out-of-bag estimates</p></li>
<li><p>A bound for the mean squared generalization error is derived that shows that the decrease in error from the individual trees in the forest depends on the correlation between residuals and the mean squared error of the individual trees.</p></li>
</ul>
<p>Generalization error:</p>
<p><span class="math display">\[
PE^* \ = \ P_{X,Y}(mg(X,Y) &lt; 0)
\]</span> Where X and Y are the training sets from the random draw and margin(mg) measures the extent to which the average number of votes at X, Y for the right class exceeds the average vote for any other class. The larger the margin, the more confidence in the classification.</p>
<p>The generalization error is the probability in x &amp; y that on average RF picks the right class. Large mg means a more confident classification.</p>
<p>I should use all of the data since I am now using bootstrap for all rfs.</p>
<p><a href="https://www.stat.berkeley.edu/~breiman/OOBestimation.pdf">Different Brieman paper for oob</a></p>
<p>I would like to read more about is using the Y variables while refining the trees. I have been using y values that are from the St.Joe example. Those might not be the best depending on how RF uses them. They do not make a difference for msn, so I didn’t have a reason to question them until now.</p>
<p>Apr 9th, pulling in new predictors.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Laurel’s email
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>compare model output to the Inland Empire estimates for the areas where your model and the Inland Empire model overlap.</p></li>
<li><p>It seems like we have a lot of data, but with high variability and many predictors, we’re probably still data-limited.</p></li>
<li><p>Did you exclude the few plots that were previously burned? (I’m thinking we should constrain this dataset to undisturbed plots or, at least, non-fire disturbance since that has a strong impact on regeneration.)</p></li>
<li><p>Maybe an outlier analysis?</p></li>
<li><p>Variable importance will be useful for refining our predictor set.</p></li>
<li><p>Check the out-of-bag error rate.</p></li>
</ul>
<p>Predictors:</p>
<p>We know that regeneration depends on microsite conditions (microclimate, soil type, shelter), seed source, precipitation in the 1-5 years following seed dispersal, facilitative interactions (mycorrhizae, shelter from other trees and plants) and competitive interactions (especially competition with understory species for water and nutrients).</p>
<p>Suggestions:</p>
<ul>
<li><p><del>Simplify FPAG, which would give us more plots per group and alleviate the data limitation issues.</del></p></li>
<li><p><del>Breaking FPAG into separate categories, so that the random forest model knows which categories are similar.</del></p></li>
<li><p><del>Species-specific basal area, because this would tell the model something about the mature trees in the stand.</del> I would remove total basal area as a predictor.- I could, but it is our best predictor at the moment.</p></li>
<li><p>One benefit of creating models separately for each FPAG would be that you can tailor the predictor set to the FPAG, so you could use just the species basal area predictors for the most abundant species in FPAG.</p></li>
<li><p>Modeling regeneration density within ecoregion.</p></li>
<li><p>Only model the most abundant species.</p></li>
</ul>
<p>Predict species-specific regen density within FPAGs, with separate FPAG classes as predictors (conifer/hardwood, dominant overstory, dominant understory), and we restrict this to the species comprising, say, 80% of the regeneration in a given FPAG? (We could experiment with this % threshold, which is a hyperparameter.)</p>
<p>Before we eliminate species, we should consider whether they’re slow- or fast-growing species and estimate how this limitation would impact our imputed seedling counts.</p>
<ul>
<li>We could use the survey time and approximate plot location to get climate data and look at things like maximum growing season temperature, climate water deficit, and growing season precipitation. Kim mentioned that head load index is a strong predictor, especially by species. I suspect some of these variables are more important for regeneration after a fire, because regen in a closed forest benefits from the microclimate therein.</li>
</ul>
<p>Stochasticity:</p>
<p>As much as I love the idea of modeling probability and counts separately and to do this with the k nearest neighbors, the preceding suggestions might be higher priority if we’re limited on time.</p>
<p>We need to compare the predicted regeneration densities for k nearest neighbors to the target and see, for each FPAG, conservatively:</p>
<ul>
<li>how many nearest neighbors are similar to the target and how quickly they diverge. Then we can determine, for each FPAG, how many k nearest neighbors to use for estimating either regen probability or counts.</li>
</ul>
<p>For using the # of neighbors that have any regen/total neighbors to get probability of regen:</p>
<ul>
<li>We generate a random number between 0 and 1 and, if that number is lower than the probability of regen, regen occurs.</li>
<li>We then draw a random neighbor from the set of k neighbors.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data tidying and access</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse, <span class="at">quietly =</span> T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(readxl)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(writexl)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># yaImpute and related </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaImpute)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plots and tables</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(esquisse)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># No sci-notation. </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># list of variables to keep. I like to clean the env. </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># load("dfs_0403/KEEP.Rdata")</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># rm(list = ls()[!ls() %in% KEEP])</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the plots of the top 50 fpags. 22721 rows, 6 preds plus fpa and physclcd</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dfs_0403/fpas.Rdata"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Best imputation so far, all predictors on clipped data. </span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dfs_0403/rf_all_ref2_i.Rdata"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># original imp_data</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dfs_0403/imp_data.Rdata"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># fpas 2, clipped imp_data</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dfs_0403/fpas_TD2900.Rdata"</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># species prevelance by FPAG. </span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dfs_0403/sp_prev_df.Rdata"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># species prevalence over all FPAGs</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dfs_0403/sp_prev3.Rdata"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data <span class="sc">|&gt;</span> </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fpa =</span> <span class="fu">str_sub</span>(FPAG, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">prevalent =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Prev"</span>,]<span class="sc">$</span>spp]),</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">common =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Comm"</span>,]<span class="sc">$</span>spp]),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">uncommon =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Uncom"</span>,]<span class="sc">$</span>spp]),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">rare =</span> <span class="fu">rowSums</span>(imp_data_FPA[,sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Rare"</span>,]<span class="sc">$</span>spp]),</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_TD =</span> <span class="fu">rowSums</span>(imp_data_FPA[<span class="fu">grep</span>(<span class="st">"_TD"</span>, <span class="fu">names</span>(imp_data_FPA))])</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Rare"</span>,]<span class="sc">$</span>spp, </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Uncom"</span>,]<span class="sc">$</span>spp, </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Comm"</span>,]<span class="sc">$</span>spp,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>sp_prev3[sp_prev3<span class="sc">$</span>prev <span class="sc">==</span> <span class="st">"Prev"</span>,]<span class="sc">$</span>spp) <span class="co">#</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(fpa, <span class="at">.after =</span> FPAG)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>imp_data_FPA <span class="ot">&lt;-</span> imp_data_FPA <span class="sc">|&gt;</span> <span class="fu">relocate</span>(PHYSCLCD, <span class="at">.before =</span> FPAG)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>fpas <span class="ot">&lt;-</span> imp_data_FPA</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing the fpags with less than 120 plots. </span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># This needs to happen for RF. Must be less than 53. </span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> <span class="fu">group_by</span>(FPAG) <span class="sc">|&gt;</span> </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">64</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> t<span class="sc">$</span>FPAG</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>fpas <span class="ot">&lt;-</span> fpas <span class="sc">|&gt;</span> </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FPAG <span class="sc">%in%</span> keep)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co"># I am not sure this is the way to set levels. </span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>fpas<span class="sc">$</span>FPAG <span class="ot">&lt;-</span> <span class="fu">factor</span>(fpas<span class="sc">$</span>FPAG, <span class="at">levels =</span> keep)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>fpas<span class="sc">$</span>fpa <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(fpas<span class="sc">$</span>fpa)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>fpas<span class="sc">$</span>PHYSCLCD <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(fpas<span class="sc">$</span>PHYSCLCD)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(keep, t)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The current version of fpas is different from the last one. I used the more thorough version of species prevalence to make it. I should probably stop doing that, it helps read the plots, but it is proving to eat up time. Plus, it makes the comparisons difficult when they don’t match.</p>
</section>
<section id="pulling-apart-fpag" class="level1">
<h1>Pulling apart FPAG</h1>
<p>I am going to proceed with fpas2 becuase I want to easily be able to compare with the 2nd ref run. That was the best imputation so far.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fpas3 <span class="ot">&lt;-</span> fpas2 <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">as.factor</span>(<span class="fu">str_sub</span>(FPAG, <span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">P =</span> <span class="fu">as.factor</span>(<span class="fu">str_sub</span>(FPAG, <span class="dv">2</span>, <span class="dv">2</span>)),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">A =</span> <span class="fu">as.factor</span>(<span class="fu">str_sub</span>(FPAG, <span class="dv">3</span>, <span class="dv">3</span>)),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">G =</span> <span class="fu">as.factor</span>(<span class="fu">str_sub</span>(FPAG, <span class="dv">4</span>, <span class="dv">4</span>)))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>KEEP <span class="ot">&lt;-</span> <span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="yai" class="level1">
<h1>Yai</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fpas2 &lt;- fpas  |&gt; filter(total_TD &lt; 2900)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fpas3 is fpas2 but with f.p.a.g. </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>refs2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(fpas3[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">nrow</span>(fpas2)<span class="sc">/</span><span class="dv">4</span>),])</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> fpas3 <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, CC, BA, SDI, ELEVFT, SLOPE, ASPECT, PHYSCLCD, f, P, A, G)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(x)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(x, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># names(fpas3)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> fpas3 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">24</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># That is the same number of rows as the 95% of the data from before. </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> yfull[refs2,]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(y)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># can't have factors in msn or mal</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># x6 &lt;- x |&gt; select(-FPAG, -PHYSCLCD)</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>yrf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">whatsMax</span>(y[ ,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(y)<span class="sc">-</span><span class="dv">1</span>)]), y[, <span class="fu">ncol</span>(y)])</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yrf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Max_SP'</span>, <span class="st">'sp_max_TD'</span>, <span class="st">'total_TD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="imps" class="level4">
<h4 class="anchored" data-anchor-id="imps">Imps</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separating this because it takes a long time and I don't want to run in by accident. </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>rf_f.p.a.g <span class="ot">&lt;-</span> <span class="fu">yai</span>(<span class="at">x =</span> x, <span class="at">y =</span> yrf, <span class="at">method =</span> <span class="st">"randomForest"</span>, <span class="at">k =</span> k)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(rf_f.p.a.g, <span class="at">file =</span> <span class="st">"imps_0402/rf_f.p.a.g.Rdata"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>rf_fpag_bs <span class="ot">&lt;-</span> <span class="fu">yai</span>(<span class="at">x =</span> x, <span class="at">y =</span> yrf, <span class="at">method =</span> <span class="st">"randomForest"</span>, <span class="at">k =</span> k, <span class="at">bootstrap =</span> T)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(rf_fpag_bs, <span class="at">file =</span> <span class="st">"imps_0402/rf_fpag_bs.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_all_refs2.Rdata"</span>) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_f.p.a.g.Rdata"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_fpag_bs.Rdata"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>rf_f.p.a.g_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_f.p.a.g, <span class="at">ancillaryData =</span> y)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>rf_fpag_bs_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_fpag_bs, <span class="at">ancillaryData =</span> y)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>rf_all_ref2_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_all_ref2, <span class="at">ancillaryData =</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>t_ns <span class="ot">&lt;-</span> <span class="fu">compare.yai</span>(rf_f.p.a.g_i, rf_fpag_bs_i, rf_all_ref2_i,  <span class="at">scale =</span> F)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">compare.yai</span>(rf_f.p.a.g_i, rf_fpag_bs_i, rf_all_ref2_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="eval" class="level2">
<h2 class="anchored" data-anchor-id="eval">eval</h2>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t_ns, <span class="at">main =</span> <span class="st">"Not Scaled"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, <span class="at">main =</span> <span class="st">"Scaled"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>I was hoping for something a little more striking. The plots don’t show a large difference. The bootstrap sample didn’t do as well as I hoped.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t_ns<span class="sc">$</span>min <span class="ot">&lt;-</span> <span class="fu">names</span>(t_ns)[<span class="fu">apply</span>(t_ns, <span class="dv">1</span>, which.min)]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>t_ns<span class="sc">$</span>min <span class="ot">&lt;-</span> t_ns<span class="sc">$</span>min <span class="sc">|&gt;</span> <span class="fu">str_sub</span>(<span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>t_ns <span class="sc">|&gt;</span> <span class="fu">arrange</span>(min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 25%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">rf_f.p.a.g_i.rmsdS</th>
<th style="text-align: right;">rf_fpag_bs_i.rmsdS</th>
<th style="text-align: right;">rf_all_ref2_i.rmsdS</th>
<th style="text-align: left;">min</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ABGR_TD</td>
<td style="text-align: right;">118.95009</td>
<td style="text-align: right;">132.47941</td>
<td style="text-align: right;">118.50571</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="even">
<td style="text-align: left;">THPL_TD</td>
<td style="text-align: right;">93.31725</td>
<td style="text-align: right;">104.48730</td>
<td style="text-align: right;">89.87215</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIEN_TD</td>
<td style="text-align: right;">57.18790</td>
<td style="text-align: right;">62.63896</td>
<td style="text-align: right;">54.79619</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="even">
<td style="text-align: left;">TSHE_TD</td>
<td style="text-align: right;">100.98928</td>
<td style="text-align: right;">110.92989</td>
<td style="text-align: right;">99.85822</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIMO3_TD</td>
<td style="text-align: right;">43.03465</td>
<td style="text-align: right;">42.01216</td>
<td style="text-align: right;">39.86885</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="even">
<td style="text-align: left;">rare</td>
<td style="text-align: right;">84.43939</td>
<td style="text-align: right;">91.32773</td>
<td style="text-align: right;">82.92543</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">133.50725</td>
<td style="text-align: right;">136.51469</td>
<td style="text-align: right;">137.84547</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABLA_TD</td>
<td style="text-align: right;">138.66340</td>
<td style="text-align: right;">157.14870</td>
<td style="text-align: right;">145.62121</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABAM_TD</td>
<td style="text-align: right;">135.34840</td>
<td style="text-align: right;">143.15201</td>
<td style="text-align: right;">138.25686</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="even">
<td style="text-align: left;">PICO_TD</td>
<td style="text-align: right;">86.08882</td>
<td style="text-align: right;">87.73905</td>
<td style="text-align: right;">92.23968</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">uncommon</td>
<td style="text-align: right;">108.65930</td>
<td style="text-align: right;">113.49455</td>
<td style="text-align: right;">110.18565</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">290.29415</td>
<td style="text-align: right;">313.93151</td>
<td style="text-align: right;">302.94122</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIPO_TD</td>
<td style="text-align: right;">62.38980</td>
<td style="text-align: right;">56.55910</td>
<td style="text-align: right;">64.25259</td>
<td style="text-align: left;">rf_fpag_b</td>
</tr>
<tr class="even">
<td style="text-align: left;">TSME_TD</td>
<td style="text-align: right;">54.68569</td>
<td style="text-align: right;">47.50446</td>
<td style="text-align: right;">52.54523</td>
<td style="text-align: left;">rf_fpag_b</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Splitting FPAG into components was a mixed bag, it was better about half the time. No major decrease in rmsd.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(t_ns<span class="sc">$</span>min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="now-what" class="level2">
<h2 class="anchored" data-anchor-id="now-what">Now what?</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>all_dist <span class="ot">&lt;-</span> <span class="fu">rmsd</span>(rf_f.p.a.g_i)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> rf_f.p.a.g_i <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">".o"</span>)) <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>all_dist<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(observed, <span class="dv">2</span>, sd)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>all_dist<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(observed, <span class="dv">2</span>, mean)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>all_dist<span class="sc">$</span>iqr <span class="ot">&lt;-</span> <span class="fu">apply</span>(observed, <span class="dv">2</span>, IQR)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>all_dist<span class="sc">$</span>q75 <span class="ot">&lt;-</span> <span class="fu">apply</span>(observed, <span class="dv">2</span>, quantile, .<span class="dv">75</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>all_dist<span class="sc">$</span>q85 <span class="ot">&lt;-</span> <span class="fu">apply</span>(observed, <span class="dv">2</span>, quantile, .<span class="dv">85</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>all_dist<span class="sc">$</span>q95 <span class="ot">&lt;-</span> <span class="fu">apply</span>(observed, <span class="dv">2</span>, quantile, .<span class="dv">95</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>all_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">rmsd</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">iqr</th>
<th style="text-align: right;">q75</th>
<th style="text-align: right;">q85</th>
<th style="text-align: right;">q95</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ABGR_TD</td>
<td style="text-align: right;">118.95009</td>
<td style="text-align: right;">146.27163</td>
<td style="text-align: right;">28.214524</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">149.93057</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIPO_TD</td>
<td style="text-align: right;">62.38980</td>
<td style="text-align: right;">64.72799</td>
<td style="text-align: right;">7.912081</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">133.50725</td>
<td style="text-align: right;">141.46196</td>
<td style="text-align: right;">36.400053</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">74.96528</td>
<td style="text-align: right;">224.89585</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABLA_TD</td>
<td style="text-align: right;">138.66340</td>
<td style="text-align: right;">195.80255</td>
<td style="text-align: right;">40.963508</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">224.89585</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSME_TD</td>
<td style="text-align: right;">54.68569</td>
<td style="text-align: right;">51.19306</td>
<td style="text-align: right;">4.523110</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABAM_TD</td>
<td style="text-align: right;">135.34840</td>
<td style="text-align: right;">193.90993</td>
<td style="text-align: right;">37.986952</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">224.89585</td>
</tr>
<tr class="odd">
<td style="text-align: left;">THPL_TD</td>
<td style="text-align: right;">93.31725</td>
<td style="text-align: right;">118.11815</td>
<td style="text-align: right;">18.307613</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">74.96528</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIEN_TD</td>
<td style="text-align: right;">57.18790</td>
<td style="text-align: right;">50.97825</td>
<td style="text-align: right;">5.625870</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSHE_TD</td>
<td style="text-align: right;">100.98928</td>
<td style="text-align: right;">117.51366</td>
<td style="text-align: right;">17.756233</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">74.96528</td>
</tr>
<tr class="even">
<td style="text-align: left;">PICO_TD</td>
<td style="text-align: right;">86.08882</td>
<td style="text-align: right;">114.58934</td>
<td style="text-align: right;">13.995193</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIMO3_TD</td>
<td style="text-align: right;">43.03465</td>
<td style="text-align: right;">36.79169</td>
<td style="text-align: right;">2.967591</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">uncommon</td>
<td style="text-align: right;">108.65930</td>
<td style="text-align: right;">98.28547</td>
<td style="text-align: right;">14.757263</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">74.96528</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rare</td>
<td style="text-align: right;">84.43939</td>
<td style="text-align: right;">84.99143</td>
<td style="text-align: right;">9.328634</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">290.29415</td>
<td style="text-align: right;">444.63723</td>
<td style="text-align: right;">238.738626</td>
<td style="text-align: right;">299.8611</td>
<td style="text-align: right;">299.8611</td>
<td style="text-align: right;">524.75698</td>
<td style="text-align: right;">1199.44452</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> <span class="fu">yaiRFsummary</span>(rf_f.p.a.g)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fp<span class="sc">$</span>forestAttributes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ntree</th>
<th style="text-align: right;">error</th>
<th style="text-align: left;">errtag</th>
<th style="text-align: right;">levels</th>
<th style="text-align: left;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2828440</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2327334</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2495366</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fp<span class="sc">$</span>scaledImportance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">BA</th>
<th style="text-align: right;">SDI</th>
<th style="text-align: right;">CC</th>
<th style="text-align: right;">ELEVFT</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">SLOPE</th>
<th style="text-align: right;">PHYSCLCD</th>
<th style="text-align: right;">G</th>
<th style="text-align: right;">ASPECT</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">1.695900</td>
<td style="text-align: right;">1.600398</td>
<td style="text-align: right;">0.2087437</td>
<td style="text-align: right;">0.3894149</td>
<td style="text-align: right;">0.4720483</td>
<td style="text-align: right;">-0.3405607</td>
<td style="text-align: right;">-0.5999133</td>
<td style="text-align: right;">-0.5151475</td>
<td style="text-align: right;">-0.5214716</td>
<td style="text-align: right;">-0.8227028</td>
<td style="text-align: right;">-1.566709</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">1.841399</td>
<td style="text-align: right;">1.900765</td>
<td style="text-align: right;">0.4871217</td>
<td style="text-align: right;">-0.2517066</td>
<td style="text-align: right;">-0.2906942</td>
<td style="text-align: right;">-0.4332867</td>
<td style="text-align: right;">-0.4589357</td>
<td style="text-align: right;">-0.4696075</td>
<td style="text-align: right;">-0.4883110</td>
<td style="text-align: right;">-0.7352846</td>
<td style="text-align: right;">-1.101460</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">1.947821</td>
<td style="text-align: right;">1.729480</td>
<td style="text-align: right;">0.5146903</td>
<td style="text-align: right;">-0.1381910</td>
<td style="text-align: right;">-0.2019244</td>
<td style="text-align: right;">-0.4598861</td>
<td style="text-align: right;">-0.4173117</td>
<td style="text-align: right;">-0.5432026</td>
<td style="text-align: right;">-0.5208850</td>
<td style="text-align: right;">-0.7176982</td>
<td style="text-align: right;">-1.192892</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>I do not know how to make a comparison for the out of bag error. I could compare apples to apples here, but I don’t have these values printed for previous runs.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_all_ref2, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_f.p.a.g, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_fpag_bs, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>The best predictors in out dataset have been BA and SDI,</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">yaiRFsummary</span>(rf_fpag_bs)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>bs<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.11433355 0.09256712 0.09759015</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fp<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2828440 0.2327334 0.2495366</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>bs<span class="sc">$</span>scaledImportance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">BA</th>
<th style="text-align: right;">SDI</th>
<th style="text-align: right;">CC</th>
<th style="text-align: right;">ASPECT</th>
<th style="text-align: right;">SLOPE</th>
<th style="text-align: right;">ELEVFT</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">PHYSCLCD</th>
<th style="text-align: right;">G</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">1.597472</td>
<td style="text-align: right;">1.433161</td>
<td style="text-align: right;">-0.0574483</td>
<td style="text-align: right;">0.5366522</td>
<td style="text-align: right;">0.0994531</td>
<td style="text-align: right;">0.2891431</td>
<td style="text-align: right;">0.0706198</td>
<td style="text-align: right;">-0.5180490</td>
<td style="text-align: right;">-0.6205876</td>
<td style="text-align: right;">-0.9997415</td>
<td style="text-align: right;">-1.830674</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">1.820365</td>
<td style="text-align: right;">1.584453</td>
<td style="text-align: right;">0.2104118</td>
<td style="text-align: right;">0.0771758</td>
<td style="text-align: right;">0.1051297</td>
<td style="text-align: right;">-0.0884000</td>
<td style="text-align: right;">-0.1817940</td>
<td style="text-align: right;">-0.4601136</td>
<td style="text-align: right;">-0.4868689</td>
<td style="text-align: right;">-0.9056247</td>
<td style="text-align: right;">-1.674734</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">1.867263</td>
<td style="text-align: right;">1.462898</td>
<td style="text-align: right;">0.2779086</td>
<td style="text-align: right;">0.1996548</td>
<td style="text-align: right;">-0.0586922</td>
<td style="text-align: right;">0.0925954</td>
<td style="text-align: right;">-0.2646747</td>
<td style="text-align: right;">-0.4194267</td>
<td style="text-align: right;">-0.5371534</td>
<td style="text-align: right;">-0.9383904</td>
<td style="text-align: right;">-1.681982</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fp<span class="sc">$</span>scaledImportance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">BA</th>
<th style="text-align: right;">SDI</th>
<th style="text-align: right;">CC</th>
<th style="text-align: right;">ELEVFT</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">SLOPE</th>
<th style="text-align: right;">PHYSCLCD</th>
<th style="text-align: right;">G</th>
<th style="text-align: right;">ASPECT</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">1.695900</td>
<td style="text-align: right;">1.600398</td>
<td style="text-align: right;">0.2087437</td>
<td style="text-align: right;">0.3894149</td>
<td style="text-align: right;">0.4720483</td>
<td style="text-align: right;">-0.3405607</td>
<td style="text-align: right;">-0.5999133</td>
<td style="text-align: right;">-0.5151475</td>
<td style="text-align: right;">-0.5214716</td>
<td style="text-align: right;">-0.8227028</td>
<td style="text-align: right;">-1.566709</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">1.841399</td>
<td style="text-align: right;">1.900765</td>
<td style="text-align: right;">0.4871217</td>
<td style="text-align: right;">-0.2517066</td>
<td style="text-align: right;">-0.2906942</td>
<td style="text-align: right;">-0.4332867</td>
<td style="text-align: right;">-0.4589357</td>
<td style="text-align: right;">-0.4696075</td>
<td style="text-align: right;">-0.4883110</td>
<td style="text-align: right;">-0.7352846</td>
<td style="text-align: right;">-1.101460</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">1.947821</td>
<td style="text-align: right;">1.729480</td>
<td style="text-align: right;">0.5146903</td>
<td style="text-align: right;">-0.1381910</td>
<td style="text-align: right;">-0.2019244</td>
<td style="text-align: right;">-0.4598861</td>
<td style="text-align: right;">-0.4173117</td>
<td style="text-align: right;">-0.5432026</td>
<td style="text-align: right;">-0.5208850</td>
<td style="text-align: right;">-0.7176982</td>
<td style="text-align: right;">-1.192892</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Adding bootstrap decreased the out-of-bag error, but didn’t do anything for rmsd? </strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fpx <span class="ot">&lt;-</span> fp<span class="sc">$</span>scaledImportance</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>bsx <span class="ot">&lt;-</span> bs<span class="sc">$</span>scaledImportance</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>order <span class="ot">&lt;-</span> <span class="fu">names</span>(fpx)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># order &lt;- c("SDI", "BA","CC","ELEVFT", "SLOPE", "ASPECT","PHYSCLCD","f", "P", "A","G")</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>bsx <span class="ot">&lt;-</span> bsx[, order]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>fpx <span class="ot">&lt;-</span> fpx[, order]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">stack</span>(fpx)) <span class="sc">+</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">y =</span> ind, <span class="at">fill =</span> ind) <span class="sc">+</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"reg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">stack</span>(bsx)) <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">y =</span> ind, <span class="at">fill =</span> ind) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bootstrap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the Brieman paper,</p>
<p>For guidance, internal estimates of the generalization error, classifier strength and dependence are computed. These are called out-of-bag estimates and are reviewed in Section 4.</p>
<p>3.1:</p>
<p>Assume a method for constructing a classifier from any training set. Given a specific training set T, form boostrap training sets Tk, (a subset of 2/3 of T) construct classifiers h(x, Tk) and let these vote to form the bagged predictor.</p>
<p>For each y, x in the training set, aggregate the votes only over those classifiers for which Tk does not containing y, x. Call this the out-of-bag classifier.</p>
<p>Then the out-of-bag estimate for the generalization error is the error rate of the out-of-bag classifier on the training set</p>
<p>From a video on youtube, the out-of-bag error is the proportion that were incorrectly classified.</p>
<p>If that’s the case, then it is odd that jumping form 20% incorrectly classified to 10% didn’t really reduce the difference in predicted vs observed y values, rmsd.</p>
</section>
</section>
<section id="moving-on" class="level1">
<h1>Moving on</h1>
<p>I can run FPA again, it didn’t do much last time. So, I am not inclined to try again, but it’s pretty easy and I can’t compare that one to these. Doing fpa would make more sense if I was still splitting off a single group to test. If splitting to letters didn’t do it, then changing to fpa won’t either.</p>
<p>I could add eco-region, I’ve been wanting to do that one.</p>
</section>
<section id="eco-region" class="level1">
<h1>eco-region</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"./attempt_032524.db"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from fvs_plotinit_plot"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from fvs_treeinit_plot"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plants_ref <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"select * from plants_ref"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ec <span class="ot">&lt;-</span> plots <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, ECOREGION)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fpas4 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(fpas3, ec, <span class="at">by =</span> <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>fpas4 <span class="ot">&lt;-</span> fpas4 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ECOREGION =</span> <span class="fu">as.factor</span>(ECOREGION)) <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">'ECOREGION'</span>, <span class="st">'f'</span>, <span class="st">'P'</span>, <span class="st">'A'</span>, <span class="st">'G'</span>), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">.after =</span> fpa)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fpas4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "STANDPLOT_CN" "CC"           "BA"           "SDI"          "ELEVFT"      
 [6] "SLOPE"        "ASPECT"       "PHYSCLCD"     "FPAG"         "fpa"         
[11] "ECOREGION"    "f"            "P"            "A"            "G"           
[16] "ABGR_TD"      "PIPO_TD"      "PSME_TD"      "ABLA_TD"      "TSME_TD"     
[21] "ABAM_TD"      "THPL_TD"      "PIEN_TD"      "TSHE_TD"      "PICO_TD"     
[26] "PIMO3_TD"     "uncommon"     "rare"         "total_TD"    </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fpas2 &lt;- fpas  |&gt; filter(total_TD &lt; 2900)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fpas3 is fpas2 but with f.p.a.g. </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>refs <span class="ot">&lt;-</span> <span class="fu">rownames</span>(fpas4[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">nrow</span>(fpas4)<span class="sc">/</span><span class="dv">4</span>),])</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> fpas4 <span class="sc">|&gt;</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(STANDPLOT_CN, CC, BA, SDI, ELEVFT, SLOPE, ASPECT, PHYSCLCD, f, P, A, G, ECOREGION)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(x)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(x, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CC"        "BA"        "SDI"       "ELEVFT"    "SLOPE"     "ASPECT"   
 [7] "PHYSCLCD"  "f"         "P"         "A"         "G"         "ECOREGION"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> fpas4 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">16</span><span class="sc">:</span><span class="fu">ncol</span>(fpas4))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># That is the same number of rows asfpas4# That is the same number of rows as the 95% of the data from before. </span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yfull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "STANDPLOT_CN" "ABGR_TD"      "PIPO_TD"      "PSME_TD"      "ABLA_TD"     
 [6] "TSME_TD"      "ABAM_TD"      "THPL_TD"      "PIEN_TD"      "TSHE_TD"     
[11] "PICO_TD"      "PIMO3_TD"     "uncommon"     "rare"         "total_TD"    </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> yfull[refs,]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(y)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># can't have factors in msn or mal</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># x6 &lt;- x |&gt; select(-FPAG, -PHYSCLCD)</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>yrf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">whatsMax</span>(y[ ,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(y)<span class="sc">-</span><span class="dv">1</span>)]), y[, <span class="fu">ncol</span>(y)])</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yrf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Max_SP'</span>, <span class="st">'sp_max_TD'</span>, <span class="st">'total_TD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="imp" class="level4">
<h4 class="anchored" data-anchor-id="imp">Imp</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separating this because it takes a long time and I don't want to run in by accident. </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rf_eco &lt;- yai(x = x, y = yrf, method = "randomForest", k = k, bootstrap = T)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># save(rf_eco, file = "imps_0402/rf_eco.Rdata")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_all_refs2.Rdata"</span>) </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_f.p.a.g.Rdata"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_fpag_bs.Rdata"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_eco.Rdata"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>rf_f.p.a.g_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_f.p.a.g, <span class="at">ancillaryData =</span> y)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>rf_fpag_bs_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_fpag_bs, <span class="at">ancillaryData =</span> y)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>rf_all_ref2_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_all_ref2, <span class="at">ancillaryData =</span> y)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>rf_eco_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_eco, <span class="at">ancillaryData =</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="ba-overstory" class="level1">
<h1>BA overstory</h1>
<p>I had this data pulled at one point. It was in my first attempt at RF.</p>
<p>There’s a few options here, I could run this by species and BA. Meaning columns for two most prevalent species and columns for thier BA.</p>
<p>I could run it with every species in the overstory as spp_BA. Looking at the plots without rare trees on the Visualization tab, it looks like at most there are three dominant species per FPAG. That is not to say a given plot doesn’t have a more even mix, but at the FPAG level, that seems to do fine.</p>
<p>The issue here is that FVS_Ready has tpa, dia, and height, but not BA. I can use dbh, but at the plot level, it’s either average or max BA.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the fvs ready tree table to my stands</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">left_join</span>(<span class="fu">select</span>(fpas4, STANDPLOT_CN), trees, <span class="at">by =</span> <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filtering out seedlings and saplings</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>tr_large <span class="ot">&lt;-</span> t <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">startsWith</span>(TREE_CN, <span class="st">"S"</span>) <span class="sc">&amp;</span> DIAMETER <span class="sc">&gt;</span> <span class="dv">5</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tpa and dia sums per species on each plot</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> tr_large <span class="sc">|&gt;</span> <span class="fu">group_by</span>(STANDPLOT_CN, SPECIES) <span class="sc">|&gt;</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TPA =</span> <span class="fu">sum</span>(TREE_COUNT),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">dia =</span> <span class="fu">sum</span>(DIAMETER),</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">dia_per_tr =</span> dia<span class="sc">/</span>TPA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'STANDPLOT_CN'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># totals of each</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> t2 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(STANDPLOT_CN) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tot_TPA =</span> <span class="fu">sum</span>(TPA), </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">tot_dia =</span> <span class="fu">sum</span>(dia))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding totals to get percents</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">left_join</span>(tt, t2, <span class="at">by =</span> <span class="st">'STANDPLOT_CN'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pcnt_tpa =</span> (TPA<span class="sc">/</span>tot_TPA)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">pcnt_dia =</span> (dia<span class="sc">/</span>tot_dia)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>tot_TPA, <span class="sc">-</span>tot_dia)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># getting plant codes</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>plants_ref <span class="ot">&lt;-</span> plants_ref <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">SPECIES =</span> <span class="fu">as.character</span>(SPCD))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">left_join</span>(t, plants_ref <span class="sc">|&gt;</span> <span class="fu">select</span>(SPECIES, SYMBL), <span class="fu">join_by</span>(SPECIES)) <span class="sc">|&gt;</span> </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>SPECIES)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>ttt <span class="ot">&lt;-</span> t <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>t <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 14%">
<col style="width: 7%">
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">STANDPLOT_CN</th>
<th style="text-align: right;">TPA</th>
<th style="text-align: right;">dia</th>
<th style="text-align: right;">dia_per_tr</th>
<th style="text-align: right;">pcnt_tpa</th>
<th style="text-align: right;">pcnt_dia</th>
<th style="text-align: left;">SYMBL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: right;">14.034468</td>
<td style="text-align: right;">91.4</td>
<td style="text-align: right;">6.512538</td>
<td style="text-align: right;">17.27698</td>
<td style="text-align: right;">43.31754</td>
<td style="text-align: left;">PIPO</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: right;">66.198506</td>
<td style="text-align: right;">93.3</td>
<td style="text-align: right;">1.409397</td>
<td style="text-align: right;">81.49298</td>
<td style="text-align: right;">44.21801</td>
<td style="text-align: left;">ABGR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: right;">0.999188</td>
<td style="text-align: right;">26.3</td>
<td style="text-align: right;">26.321373</td>
<td style="text-align: right;">1.23004</td>
<td style="text-align: right;">12.46445</td>
<td style="text-align: left;">LAOC</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>t4 <span class="ot">&lt;-</span> tr_large <span class="sc">|&gt;</span> <span class="fu">filter</span>(STANDPLOT_CN <span class="sc">==</span> <span class="st">'12964130010497_1'</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">16</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>t4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">STANDPLOT_CN</th>
<th style="text-align: left;">STAND_CN</th>
<th style="text-align: left;">PLOT_CN</th>
<th style="text-align: right;">PLOT_ID</th>
<th style="text-align: left;">TREE_CN</th>
<th style="text-align: right;">TREE_ID</th>
<th style="text-align: right;">AZIMUTH</th>
<th style="text-align: right;">DISTANCE</th>
<th style="text-align: right;">TREE_COUNT</th>
<th style="text-align: right;">WDLND_STEMS</th>
<th style="text-align: right;">HISTORY</th>
<th style="text-align: left;">SPECIES</th>
<th style="text-align: right;">DIAMETER</th>
<th style="text-align: right;">DIAMETER_HTCD</th>
<th style="text-align: right;">DG</th>
<th style="text-align: right;">HT</th>
<th style="text-align: right;">HTG</th>
<th style="text-align: right;">HTTOPK</th>
<th style="text-align: right;">HT_TO_CROWN_BASE</th>
<th style="text-align: right;">CRRATIO</th>
<th style="text-align: right;">UNCRRATIO</th>
<th style="text-align: right;">CRCLASS</th>
<th style="text-align: right;">DAMAGE1</th>
<th style="text-align: right;">SEVERITY1</th>
<th style="text-align: right;">DAMAGE2</th>
<th style="text-align: right;">SEVERITY2</th>
<th style="text-align: right;">DAMAGE3</th>
<th style="text-align: right;">SEVERITY3</th>
<th style="text-align: right;">AGE</th>
<th style="text-align: right;">SLOPE</th>
<th style="text-align: right;">ASPECT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964327010497</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">9.3</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">20.3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964330010497</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">43.5</td>
<td style="text-align: right;">0.999188</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">122</td>
<td style="text-align: right;">27.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964333010497</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">174</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">0.999188</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">122</td>
<td style="text-align: right;">25.8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964336010497</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">14.5</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964339010497</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">204</td>
<td style="text-align: right;">10.3</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964342010497</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">222</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">122</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964345010497</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964348010497</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">18.9</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">7.9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964351010497</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">284</td>
<td style="text-align: right;">11.7</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964354010497</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">290</td>
<td style="text-align: right;">11.3</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964357010497</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">292</td>
<td style="text-align: right;">23.8</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964360010497</td>
<td style="text-align: right;">111</td>
<td style="text-align: right;">301</td>
<td style="text-align: right;">21.5</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964363010497</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">301</td>
<td style="text-align: right;">23.6</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964366010497</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">328</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964369010497</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">344</td>
<td style="text-align: right;">32.1</td>
<td style="text-align: right;">0.999188</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">73</td>
<td style="text-align: right;">26.3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: left;">12964130010497</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">12964371010497</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">353</td>
<td style="text-align: right;">13.8</td>
<td style="text-align: right;">6.018046</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">122</td>
<td style="text-align: right;">15.3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>I think I want to maximize the diameter per tree, but the data is set so that the largest trees count as .99, and middle size trees count as 6.06. There is probably a way to get this perfect, but I am not sure right now. Without grouping the diameters into classes, there’s no good way to separate 10 trees with diameter of 6 from one tree with a diameter of 60. Different species are going to have different diameters at maturity. This is only to get RF to know what the major species are there. I am going with diameter.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(tr_large<span class="sc">$</span>TREE_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(tr_large<span class="sc">$</span>TREE_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  6.018046  0.999188 74.965282</code></pre>
</div>
</div>
<p>There are no records in tr_large that counted multiples of a given species with the same dimensions. Those 74.9’s are weird, they should only be counted like that under 5in in diameter.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> t <span class="sc">|&gt;</span> <span class="fu">group_by</span>(STANDPLOT_CN) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(dia)) <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, dia, SYMBL)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>t <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">STANDPLOT_CN</th>
<th style="text-align: right;">dia</th>
<th style="text-align: left;">SYMBL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: right;">93.3</td>
<td style="text-align: left;">ABGR</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: right;">91.4</td>
<td style="text-align: left;">PIPO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_1</td>
<td style="text-align: right;">26.3</td>
<td style="text-align: left;">LAOC</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_2</td>
<td style="text-align: right;">118.6</td>
<td style="text-align: left;">PIPO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12964130010497_2</td>
<td style="text-align: right;">47.9</td>
<td style="text-align: left;">ABGR</td>
</tr>
<tr class="even">
<td style="text-align: left;">12964130010497_3</td>
<td style="text-align: right;">110.8</td>
<td style="text-align: left;">ABGR</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fpa_cn <span class="ot">&lt;-</span> fpas4 <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">left_join</span>(fpa_cn, t, <span class="at">by =</span> <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(tt<span class="sc">$</span>SYMBL))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 493</code></pre>
</div>
</div>
<p>493 rows are empty, those are in fpas4, but don’t have major overstory species? This is built off of fpas2, that already has the empty total_TDs removed. So, these plots have seedlings but not large trees.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> tt <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> SYMBL, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_from =</span> dia, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_fill =</span> <span class="dv">0</span>, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_glue =</span> <span class="st">"{SYMBL}_{'dia'}"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>fpas5 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(fpas4, t3, <span class="at">by =</span> <span class="st">"STANDPLOT_CN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fpas2 &lt;- fpas  |&gt; filter(total_TD &lt; 2900)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fpas3 is fpas2 but with f.p.a.g. </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>refs <span class="ot">&lt;-</span> <span class="fu">rownames</span>(fpas5[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">nrow</span>(fpas5)<span class="sc">/</span><span class="dv">4</span>),])</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">names</span>(fpas5)[<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds[<span class="sc">!</span>preds <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"FPAG"</span>, <span class="st">"fpa"</span>)]</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>dias <span class="ot">&lt;-</span> t3 <span class="sc">|&gt;</span> <span class="fu">names</span>()</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">append</span>(preds, <span class="fu">all_of</span>(dias[<span class="dv">2</span><span class="sc">:</span><span class="dv">39</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `all_of()` outside of a selecting function was deprecated in tidyselect
1.2.0.
ℹ See details at
  &lt;https://tidyselect.r-lib.org/reference/faq-selection-context.html&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> fpas5 <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(STANDPLOT_CN, preds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(preds)

  # Now:
  data %&gt;% select(all_of(preds))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- left_join(x, t3, by = 'STANDPLOT_CN')</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(x)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(x, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CC"         "BA"         "SDI"        "ELEVFT"     "SLOPE"     
 [6] "ASPECT"     "PHYSCLCD"   "ECOREGION"  "f"          "P"         
[11] "A"          "G"          "ABGR_dia"   "PIPO_dia"   "LAOC_dia"  
[16] "PSME_dia"   "TSME_dia"   "PIAL_dia"   "LALY_dia"   "ABAM_dia"  
[21] "PIMO3_dia"  "PICO_dia"   "ABLA_dia"   "PIEN_dia"   "NA_dia"    
[26] "TSHE_dia"   "THPL_dia"   "CHNO_dia"   "ACGL_dia"   "POTR5_dia" 
[31] "POBAT_dia"  "BEPA_dia"   "2TE_dia"    "CONU4_dia"  "QUGA4_dia" 
[36] "BEOC2_dia"  "ACMA3_dia"  "ALRH2_dia"  "ALRU2_dia"  "ABPR_dia"  
[41] "PREM_dia"   "PRVI_dia"   "PISI_dia"   "2TB_dia"    "ABCO_dia"  
[46] "ARME_dia"   "TABR2_dia"  "FRLA_dia"   "MAFU_dia"   "CHCHC4_dia"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> fpas5 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>preds, <span class="sc">-</span><span class="fu">c</span>(FPAG, fpa))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># That is the same number of rows asfpas4# That is the same number of rows as the 95% of the data from before. </span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yfull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "STANDPLOT_CN" "ABGR_TD"      "PIPO_TD"      "PSME_TD"      "ABLA_TD"     
 [6] "TSME_TD"      "ABAM_TD"      "THPL_TD"      "PIEN_TD"      "TSHE_TD"     
[11] "PICO_TD"      "PIMO3_TD"     "uncommon"     "rare"         "total_TD"    </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> yfull[refs,]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(y)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># can't have factors in msn or mal</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># x6 &lt;- x |&gt; select(-FPAG, -PHYSCLCD)</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>yrf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">whatsMax</span>(y[ ,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(y)<span class="sc">-</span><span class="dv">1</span>)]), y[, <span class="fu">ncol</span>(y)])</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yrf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Max_SP'</span>, <span class="st">'sp_max_TD'</span>, <span class="st">'total_TD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="imp-1" class="level4">
<h4 class="anchored" data-anchor-id="imp-1">Imp</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separating this because it takes a long time and I don't want to run in by accident. </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>rf_dia <span class="ot">&lt;-</span> <span class="fu">yai</span>(<span class="at">x =</span> x, <span class="at">y =</span> yrf, <span class="at">method =</span> <span class="st">"randomForest"</span>, <span class="at">k =</span> k, <span class="at">bootstrap =</span> T)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(rf_dia, <span class="at">file =</span> <span class="st">"imps_0402/rf_dia.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="lets-see" class="level2">
<h2 class="anchored" data-anchor-id="lets-see">Let’s see</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_dia.Rdata"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>rf_dia_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_dia, <span class="at">ancillaryData =</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>t_ns <span class="ot">&lt;-</span> <span class="fu">compare.yai</span>(rf_f.p.a.g_i, rf_fpag_bs_i, rf_eco_i, rf_dia_i, rf_all_ref2_i,  <span class="at">scale =</span> F)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">compare.yai</span>(rf_f.p.a.g_i, rf_fpag_bs_i, rf_eco_i, rf_dia_i, rf_all_ref2_i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="eval-1" class="level2">
<h2 class="anchored" data-anchor-id="eval-1">eval</h2>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t_ns, <span class="at">main =</span> <span class="st">"Not Scaled"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, <span class="at">main =</span> <span class="st">"Scaled"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>I am not sure this is going to work any better. I am having a hard time believing that didn’t do anything.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>t_ns<span class="sc">$</span>min <span class="ot">&lt;-</span> <span class="fu">names</span>(t_ns)[<span class="fu">apply</span>(t_ns, <span class="dv">1</span>, which.min)]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>t_ns<span class="sc">$</span>min <span class="ot">&lt;-</span> t_ns<span class="sc">$</span>min <span class="sc">|&gt;</span> <span class="fu">str_sub</span>(<span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>t_ns <span class="sc">|&gt;</span> <span class="fu">arrange</span>(min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 18%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">rf_f.p.a.g_i.rmsdS</th>
<th style="text-align: right;">rf_fpag_bs_i.rmsdS</th>
<th style="text-align: right;">rf_eco_i.rmsdS</th>
<th style="text-align: right;">rf_dia_i.rmsdS</th>
<th style="text-align: right;">rf_all_ref2_i.rmsdS</th>
<th style="text-align: left;">min</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ABGR_TD</td>
<td style="text-align: right;">118.95009</td>
<td style="text-align: right;">132.47941</td>
<td style="text-align: right;">131.40519</td>
<td style="text-align: right;">127.40337</td>
<td style="text-align: right;">118.50571</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="even">
<td style="text-align: left;">THPL_TD</td>
<td style="text-align: right;">93.31725</td>
<td style="text-align: right;">104.48730</td>
<td style="text-align: right;">97.57319</td>
<td style="text-align: right;">97.75719</td>
<td style="text-align: right;">89.87215</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSHE_TD</td>
<td style="text-align: right;">100.98928</td>
<td style="text-align: right;">110.92989</td>
<td style="text-align: right;">107.33042</td>
<td style="text-align: right;">107.40178</td>
<td style="text-align: right;">99.85822</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="even">
<td style="text-align: left;">rare</td>
<td style="text-align: right;">84.43939</td>
<td style="text-align: right;">91.32773</td>
<td style="text-align: right;">87.29527</td>
<td style="text-align: right;">82.98835</td>
<td style="text-align: right;">82.92543</td>
<td style="text-align: left;">rf_all_re</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TSME_TD</td>
<td style="text-align: right;">54.68569</td>
<td style="text-align: right;">47.50446</td>
<td style="text-align: right;">51.30634</td>
<td style="text-align: right;">44.46117</td>
<td style="text-align: right;">52.54523</td>
<td style="text-align: left;">rf_dia_i.</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIEN_TD</td>
<td style="text-align: right;">57.18790</td>
<td style="text-align: right;">62.63896</td>
<td style="text-align: right;">57.17974</td>
<td style="text-align: right;">54.07475</td>
<td style="text-align: right;">54.79619</td>
<td style="text-align: left;">rf_dia_i.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIMO3_TD</td>
<td style="text-align: right;">43.03465</td>
<td style="text-align: right;">42.01216</td>
<td style="text-align: right;">35.24496</td>
<td style="text-align: right;">37.30043</td>
<td style="text-align: right;">39.86885</td>
<td style="text-align: left;">rf_eco_i.</td>
</tr>
<tr class="even">
<td style="text-align: left;">uncommon</td>
<td style="text-align: right;">108.65930</td>
<td style="text-align: right;">113.49455</td>
<td style="text-align: right;">108.06836</td>
<td style="text-align: right;">113.52918</td>
<td style="text-align: right;">110.18565</td>
<td style="text-align: left;">rf_eco_i.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSME_TD</td>
<td style="text-align: right;">133.50725</td>
<td style="text-align: right;">136.51469</td>
<td style="text-align: right;">139.28826</td>
<td style="text-align: right;">138.46690</td>
<td style="text-align: right;">137.84547</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABLA_TD</td>
<td style="text-align: right;">138.66340</td>
<td style="text-align: right;">157.14870</td>
<td style="text-align: right;">159.31184</td>
<td style="text-align: right;">164.11334</td>
<td style="text-align: right;">145.62121</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABAM_TD</td>
<td style="text-align: right;">135.34840</td>
<td style="text-align: right;">143.15201</td>
<td style="text-align: right;">148.01245</td>
<td style="text-align: right;">152.92036</td>
<td style="text-align: right;">138.25686</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="even">
<td style="text-align: left;">PICO_TD</td>
<td style="text-align: right;">86.08882</td>
<td style="text-align: right;">87.73905</td>
<td style="text-align: right;">87.32684</td>
<td style="text-align: right;">95.80544</td>
<td style="text-align: right;">92.23968</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">290.29415</td>
<td style="text-align: right;">313.93151</td>
<td style="text-align: right;">343.35150</td>
<td style="text-align: right;">370.79256</td>
<td style="text-align: right;">302.94122</td>
<td style="text-align: left;">rf_f.p.a.</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIPO_TD</td>
<td style="text-align: right;">62.38980</td>
<td style="text-align: right;">56.55910</td>
<td style="text-align: right;">58.08051</td>
<td style="text-align: right;">67.49800</td>
<td style="text-align: right;">64.25259</td>
<td style="text-align: left;">rf_fpag_b</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(t_ns<span class="sc">$</span>min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ep <span class="ot">&lt;-</span> <span class="fu">yaiRFsummary</span>(rf_f.p.a.g)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>ep<span class="sc">$</span>forestAttributes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ntree</th>
<th style="text-align: right;">error</th>
<th style="text-align: left;">errtag</th>
<th style="text-align: right;">levels</th>
<th style="text-align: left;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2828440</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2327334</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2495366</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ep<span class="sc">$</span>scaledImportance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">BA</th>
<th style="text-align: right;">SDI</th>
<th style="text-align: right;">CC</th>
<th style="text-align: right;">ELEVFT</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">SLOPE</th>
<th style="text-align: right;">PHYSCLCD</th>
<th style="text-align: right;">G</th>
<th style="text-align: right;">ASPECT</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">1.695900</td>
<td style="text-align: right;">1.600398</td>
<td style="text-align: right;">0.2087437</td>
<td style="text-align: right;">0.3894149</td>
<td style="text-align: right;">0.4720483</td>
<td style="text-align: right;">-0.3405607</td>
<td style="text-align: right;">-0.5999133</td>
<td style="text-align: right;">-0.5151475</td>
<td style="text-align: right;">-0.5214716</td>
<td style="text-align: right;">-0.8227028</td>
<td style="text-align: right;">-1.566709</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">1.841399</td>
<td style="text-align: right;">1.900765</td>
<td style="text-align: right;">0.4871217</td>
<td style="text-align: right;">-0.2517066</td>
<td style="text-align: right;">-0.2906942</td>
<td style="text-align: right;">-0.4332867</td>
<td style="text-align: right;">-0.4589357</td>
<td style="text-align: right;">-0.4696075</td>
<td style="text-align: right;">-0.4883110</td>
<td style="text-align: right;">-0.7352846</td>
<td style="text-align: right;">-1.101460</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">1.947821</td>
<td style="text-align: right;">1.729480</td>
<td style="text-align: right;">0.5146903</td>
<td style="text-align: right;">-0.1381910</td>
<td style="text-align: right;">-0.2019244</td>
<td style="text-align: right;">-0.4598861</td>
<td style="text-align: right;">-0.4173117</td>
<td style="text-align: right;">-0.5432026</td>
<td style="text-align: right;">-0.5208850</td>
<td style="text-align: right;">-0.7176982</td>
<td style="text-align: right;">-1.192892</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">yaiRFsummary</span>(rf_fpag_bs)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>dp<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.11433355 0.09256712 0.09759015</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ep<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2828440 0.2327334 0.2495366</code></pre>
</div>
</div>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_all_ref2, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_f.p.a.g, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_fpag_bs, </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_eco, </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_dia, </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-36-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-36-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>tdia <span class="ot">&lt;-</span> <span class="fu">yaiVarImp</span>(rf_dia, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">yaiVarImp</span>(rf_eco, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">stack</span>(t2)) <span class="sc">+</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">y =</span> ind, <span class="at">fill =</span> ind) <span class="sc">+</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"eco"</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> tdia <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>t4 <span class="ot">&lt;-</span> tdia <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">stack</span>(t3)) <span class="sc">+</span> </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">y =</span> ind, <span class="at">fill =</span> ind) <span class="sc">+</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span> </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">2.2</span>)<span class="sc">+</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"dia1"</span>)<span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">stack</span>(t4)) <span class="sc">+</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">y =</span> ind, <span class="at">fill =</span> ind) <span class="sc">+</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">2.2</span>)<span class="sc">+</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"dia2"</span>)<span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-38-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>tdia</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">SDI</th>
<th style="text-align: right;">BA</th>
<th style="text-align: right;">ECOREGION</th>
<th style="text-align: right;">CC</th>
<th style="text-align: right;">SLOPE</th>
<th style="text-align: right;">ASPECT</th>
<th style="text-align: right;">PSME_dia</th>
<th style="text-align: right;">PHYSCLCD</th>
<th style="text-align: right;">ELEVFT</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">G</th>
<th style="text-align: right;">PICO_dia</th>
<th style="text-align: right;">LAOC_dia</th>
<th style="text-align: right;">ABGR_dia</th>
<th style="text-align: right;">PIEN_dia</th>
<th style="text-align: right;">THPL_dia</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">ABLA_dia</th>
<th style="text-align: right;">PIMO3_dia</th>
<th style="text-align: right;">ACGL_dia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">1.972060</td>
<td style="text-align: right;">2.315345</td>
<td style="text-align: right;">1.388419</td>
<td style="text-align: right;">1.627459</td>
<td style="text-align: right;">1.610900</td>
<td style="text-align: right;">3.227255</td>
<td style="text-align: right;">1.161338</td>
<td style="text-align: right;">0.9718119</td>
<td style="text-align: right;">1.228096</td>
<td style="text-align: right;">0.7128546</td>
<td style="text-align: right;">0.4162654</td>
<td style="text-align: right;">0.4830294</td>
<td style="text-align: right;">0.2487614</td>
<td style="text-align: right;">0.4523900</td>
<td style="text-align: right;">-0.2539388</td>
<td style="text-align: right;">0.2038247</td>
<td style="text-align: right;">0.1872914</td>
<td style="text-align: right;">0.3531449</td>
<td style="text-align: right;">-0.0294391</td>
<td style="text-align: right;">0.1827650</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">2.309091</td>
<td style="text-align: right;">1.893425</td>
<td style="text-align: right;">2.308549</td>
<td style="text-align: right;">1.844762</td>
<td style="text-align: right;">1.738563</td>
<td style="text-align: right;">1.446530</td>
<td style="text-align: right;">1.167131</td>
<td style="text-align: right;">1.1300967</td>
<td style="text-align: right;">1.003781</td>
<td style="text-align: right;">0.6131874</td>
<td style="text-align: right;">0.9665278</td>
<td style="text-align: right;">0.8702458</td>
<td style="text-align: right;">0.5257517</td>
<td style="text-align: right;">0.5705896</td>
<td style="text-align: right;">0.2687012</td>
<td style="text-align: right;">0.0700969</td>
<td style="text-align: right;">0.1912796</td>
<td style="text-align: right;">0.1719856</td>
<td style="text-align: right;">0.1560697</td>
<td style="text-align: right;">0.0899448</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">2.411675</td>
<td style="text-align: right;">2.103923</td>
<td style="text-align: right;">1.953972</td>
<td style="text-align: right;">1.916024</td>
<td style="text-align: right;">1.670769</td>
<td style="text-align: right;">1.448258</td>
<td style="text-align: right;">1.107379</td>
<td style="text-align: right;">1.7302182</td>
<td style="text-align: right;">1.001100</td>
<td style="text-align: right;">0.8028473</td>
<td style="text-align: right;">0.6375823</td>
<td style="text-align: right;">0.6091290</td>
<td style="text-align: right;">0.4594596</td>
<td style="text-align: right;">0.4564329</td>
<td style="text-align: right;">0.2114932</td>
<td style="text-align: right;">0.4706413</td>
<td style="text-align: right;">0.2308239</td>
<td style="text-align: right;">0.1402233</td>
<td style="text-align: right;">0.2316675</td>
<td style="text-align: right;">-0.1211336</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>I am not sure what to think about that. It didn’t perform better.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>try <span class="ot">&lt;-</span> t3 <span class="sc">|&gt;</span> <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="removing-negative-preds" class="level1">
<h1>Removing negative preds</h1>
<p>f, A, G, &amp; Physclcd are almost always negative.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>refs <span class="ot">&lt;-</span> <span class="fu">rownames</span>(fpas4[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">nrow</span>(fpas4)<span class="sc">/</span><span class="dv">4</span>),])</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- fpas4 |&gt; </span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(STANDPLOT_CN, CC, BA, SDI, ELEVFT, SLOPE, ASPECT,f, P, A, ECOREGION) |&gt; </span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fpa = as.factor(str_c(f, P, A))) |&gt; select(-c(f, P, A))</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> fpas5 <span class="sc">|&gt;</span> <span class="fu">select</span>(STANDPLOT_CN, <span class="fu">all_of</span>(try))</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(x)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(x, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SDI"       "BA"        "ECOREGION" "CC"        "SLOPE"     "ASPECT"   
 [7] "PSME_dia"  "PHYSCLCD"  "ELEVFT"    "P"        </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>yfull <span class="ot">&lt;-</span> fpas4 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">16</span><span class="sc">:</span><span class="fu">ncol</span>(fpas4))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># That is the same number of rows asfpas4# That is the same number of rows as the 95% of the data from before. </span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>yvars <span class="ot">&lt;-</span> <span class="fu">names</span>(yfull)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yfull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "STANDPLOT_CN" "ABGR_TD"      "PIPO_TD"      "PSME_TD"      "ABLA_TD"     
 [6] "TSME_TD"      "ABAM_TD"      "THPL_TD"      "PIEN_TD"      "TSHE_TD"     
[11] "PICO_TD"      "PIMO3_TD"     "uncommon"     "rare"         "total_TD"    </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> yfull[refs,]</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">remove_rownames</span>(y)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(y, <span class="st">"STANDPLOT_CN"</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># can't have factors in msn or mal</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># x6 &lt;- x |&gt; select(-FPAG, -PHYSCLCD)</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>yrf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">whatsMax</span>(y[ ,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(y)<span class="sc">-</span><span class="dv">1</span>)]), y[, <span class="fu">ncol</span>(y)])</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yrf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Max_SP'</span>, <span class="st">'sp_max_TD'</span>, <span class="st">'total_TD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separating this because it takes a long time and I don't want to run in by accident. </span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rf_dia2 &lt;- yai(x = x, y = yrf, method = "randomForest", k = k, bootstrap = T)</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># save(rf_dia2, file = "imps_0402/rf_dia2.Rdata")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_eco2.Rdata"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"imps_0402/rf_dia2.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rf_eco2_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_eco2, <span class="at">ancillaryData =</span> y)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rf_dia2_i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_dia2, <span class="at">ancillaryData =</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>t_ns <span class="ot">&lt;-</span> <span class="fu">compare.yai</span>(rf_fpag_bs_i, rf_eco_i, rf_dia_i, rf_eco2_i, rf_dia2_i,  <span class="at">scale =</span> F)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">compare.yai</span>(rf_fpag_bs_i, rf_eco_i, rf_dia_i, rf_eco2_i, rf_dia2_i)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t_ns, <span class="at">main =</span> <span class="st">"Not Scaled"</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, <span class="at">main =</span> <span class="st">"Scaled"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_eco2, </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiVarImp</span>(rf_dia2, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Interesting that the scaled importance goes down per variable when there are fewer bad ones. I guess because it’s scaled. Striking difference between all other variables and SDI/BA.</p>
</section>
<section id="oob-errors" class="level1">
<h1>OOB errors</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"./imps_0402/rf_all_ps.Rdata"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">yaiRFsummary</span>(rf_all_ref2)<span class="sc">$</span>forestAttributes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ntree</th>
<th style="text-align: right;">error</th>
<th style="text-align: left;">errtag</th>
<th style="text-align: right;">levels</th>
<th style="text-align: left;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2881062</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2368594</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.2549782</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">allP =</span> <span class="fu">yaiRFsummary</span>(rf_all_ps)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>],</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref2 =</span> <span class="fu">yaiRFsummary</span>(rf_all_ref2)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>],</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">f.p.a.g =</span> <span class="fu">yaiRFsummary</span>(rf_f.p.a.g)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>],</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fpag_bs =</span> <span class="fu">yaiRFsummary</span>(rf_fpag_bs)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>],</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dia =</span> <span class="fu">yaiRFsummary</span>(rf_dia)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>],</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dia2 =</span> <span class="fu">yaiRFsummary</span>(rf_dia2)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>],</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">eco =</span> <span class="fu">yaiRFsummary</span>(rf_eco)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>],</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">eco2 =</span> <span class="fu">yaiRFsummary</span>(rf_eco2)<span class="sc">$</span>forestAttributes[,<span class="st">"error"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$allP
[1] 0.289553991 0.004284038 0.005751174

$ref2
[1] 0.2881062 0.2368594 0.2549782

$f.p.a.g
[1] 0.2828440 0.2327334 0.2495366

$fpag_bs
[1] 0.11433355 0.09256712 0.09759015

$dia
[1] 0.1231231 0.1001410 0.1097015

$dia2
[1] 0.10554326 0.08814208 0.09304551

$eco
[1] 0.10889195 0.09041440 0.09938408

$eco2
[1] 0.10841356 0.08975662 0.09591580</code></pre>
</div>
</div>
<p><strong>Dia 2 is the best by out of bag error.</strong></p>
<p>I think that has something to do with the yrf variables used when running the yai. They do not make it clear how they are calculating oob. Even in the Briemen paper, it’s a hazy.</p>
<section id="checking-on-oob-v-rmsd" class="level2">
<h2 class="anchored" data-anchor-id="checking-on-oob-v-rmsd">Checking on OOB v rmsd</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>rfalli <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_all_ref2)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>rfecoi <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_eco)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>rfeco2i <span class="ot">&lt;-</span> <span class="fu">impute</span>(rf_eco2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare.yai</span>(rfalli, rfecoi, rfeco2i, <span class="at">scale =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">rfalli.rmsdS</th>
<th style="text-align: right;">rfecoi.rmsdS</th>
<th style="text-align: right;">rfeco2i.rmsdS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">267.673793</td>
<td style="text-align: right;">291.948096</td>
<td style="text-align: right;">275.971248</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">302.941221</td>
<td style="text-align: right;">332.421040</td>
<td style="text-align: right;">313.585518</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">CC</td>
<td style="text-align: right;">4.252763</td>
<td style="text-align: right;">5.277792</td>
<td style="text-align: right;">4.633257</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BA</td>
<td style="text-align: right;">5.876051</td>
<td style="text-align: right;">7.389639</td>
<td style="text-align: right;">7.155070</td>
</tr>
<tr class="even">
<td style="text-align: left;">SDI</td>
<td style="text-align: right;">9.757234</td>
<td style="text-align: right;">12.903440</td>
<td style="text-align: right;">10.231163</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ELEVFT</td>
<td style="text-align: right;">475.002085</td>
<td style="text-align: right;">473.158037</td>
<td style="text-align: right;">524.532333</td>
</tr>
<tr class="even">
<td style="text-align: left;">SLOPE</td>
<td style="text-align: right;">12.798348</td>
<td style="text-align: right;">14.815223</td>
<td style="text-align: right;">12.962548</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ASPECT</td>
<td style="text-align: right;">67.650840</td>
<td style="text-align: right;">78.617229</td>
<td style="text-align: right;">70.398888</td>
</tr>
<tr class="even">
<td style="text-align: left;">PHYSCLCD</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FPAG</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">G</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ECOREGION</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fpa</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare.yai</span>(rfalli, rfecoi, rfeco2i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">rfalli.rmsdS</th>
<th style="text-align: right;">rfecoi.rmsdS</th>
<th style="text-align: right;">rfeco2i.rmsdS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">0.7117018</td>
<td style="text-align: right;">0.7653512</td>
<td style="text-align: right;">0.7398054</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.6813222</td>
<td style="text-align: right;">0.7397031</td>
<td style="text-align: right;">0.7081707</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">CC</td>
<td style="text-align: right;">0.3121773</td>
<td style="text-align: right;">0.3837093</td>
<td style="text-align: right;">0.3386665</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BA</td>
<td style="text-align: right;">0.2081337</td>
<td style="text-align: right;">0.2632020</td>
<td style="text-align: right;">0.2506304</td>
</tr>
<tr class="even">
<td style="text-align: left;">SDI</td>
<td style="text-align: right;">0.1624944</td>
<td style="text-align: right;">0.2151085</td>
<td style="text-align: right;">0.1687008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ELEVFT</td>
<td style="text-align: right;">0.3724909</td>
<td style="text-align: right;">0.3710546</td>
<td style="text-align: right;">0.4093532</td>
</tr>
<tr class="even">
<td style="text-align: left;">SLOPE</td>
<td style="text-align: right;">0.5762814</td>
<td style="text-align: right;">0.6656794</td>
<td style="text-align: right;">0.5803803</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ASPECT</td>
<td style="text-align: right;">0.6212315</td>
<td style="text-align: right;">0.7199769</td>
<td style="text-align: right;">0.6466034</td>
</tr>
<tr class="even">
<td style="text-align: left;">PHYSCLCD</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FPAG</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">G</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ECOREGION</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fpa</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare.yai</span>(rfalli, rfecoi, rfeco2i))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">stack</span>(t4)) <span class="sc">+</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">y =</span> ind, <span class="at">fill =</span> ind) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span> </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">2.2</span>)<span class="sc">+</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"dia2"</span>)<span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="7_Predictors_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>ya <span class="ot">&lt;-</span> <span class="fu">yaiRFsummary</span>(rf_eco2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>ya<span class="sc">$</span>forestAttributes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ntree</th>
<th style="text-align: right;">error</th>
<th style="text-align: left;">errtag</th>
<th style="text-align: right;">levels</th>
<th style="text-align: left;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.1084136</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.0897566</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">0.0959158</td>
<td style="text-align: left;">OOB error rate</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">classification</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare.yai</span>(rfalli, rfecoi, rfeco2i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">rfalli.rmsdS</th>
<th style="text-align: right;">rfecoi.rmsdS</th>
<th style="text-align: right;">rfeco2i.rmsdS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sp_max_TD</td>
<td style="text-align: right;">0.7117018</td>
<td style="text-align: right;">0.7653512</td>
<td style="text-align: right;">0.7398054</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_TD</td>
<td style="text-align: right;">0.6813222</td>
<td style="text-align: right;">0.7397031</td>
<td style="text-align: right;">0.7081707</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Max_SP</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">CC</td>
<td style="text-align: right;">0.3121773</td>
<td style="text-align: right;">0.3837093</td>
<td style="text-align: right;">0.3386665</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BA</td>
<td style="text-align: right;">0.2081337</td>
<td style="text-align: right;">0.2632020</td>
<td style="text-align: right;">0.2506304</td>
</tr>
<tr class="even">
<td style="text-align: left;">SDI</td>
<td style="text-align: right;">0.1624944</td>
<td style="text-align: right;">0.2151085</td>
<td style="text-align: right;">0.1687008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ELEVFT</td>
<td style="text-align: right;">0.3724909</td>
<td style="text-align: right;">0.3710546</td>
<td style="text-align: right;">0.4093532</td>
</tr>
<tr class="even">
<td style="text-align: left;">SLOPE</td>
<td style="text-align: right;">0.5762814</td>
<td style="text-align: right;">0.6656794</td>
<td style="text-align: right;">0.5803803</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ASPECT</td>
<td style="text-align: right;">0.6212315</td>
<td style="text-align: right;">0.7199769</td>
<td style="text-align: right;">0.6466034</td>
</tr>
<tr class="even">
<td style="text-align: left;">PHYSCLCD</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FPAG</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">G</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ECOREGION</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fpa</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list(</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   allP = yaiRFsummary(rfalli)$forestAttributes[,"error"],</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   ref2 = yaiRFsummary(rfecoi)$forestAttributes[,"error"],</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   f.p.a.g = $forestAttributes[,"error"],</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I do not know why there is an OOBe for max_sp, but not an rmsd.</p>
<p><span class="math display">\[
PE^* \ = \ P_{X,Y}(mg(X,Y) &lt; 0)
\]</span></p>
<p>For rmsd:</p>
<p><span class="math display">\[
rmsd \ = \ \sqrt{E(\sum(y_t - y_r)^2/n) +2 \ var(Error_{measured}) + 2 var(Error_{btw(X,Y)})}
\]</span></p>
<p>rmsd is the RMS between the targets and the references + error from measurement and error that is naturaly between the variables. For each y variable, the difference between the imputed and observed values.</p>
<p>Scaled:</p>
<p><span class="math display">\[
\frac{\sqrt{\sum(y_t - y_r)^2/n) + e}}{\sqrt{\sum{(x_i - \mu)^2/(n-1)}}}
\]</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>